---
title: 63 按位运算
toc: true
date: 2018-10-22
---
# 按位运算

这里包括的按位操作有： AND， OR， NOT， XOR 等。当我们提取图像的一部分，选择非矩形 ROI 时这些操作会很有用（下一章你就会明白）。<span style="color:red;">嗯，的确，相当于用一个 mask 限定住了我们想要的范围。</span>


下面的例子就是教给我们如何改变一幅图的特定区域。

我想把 OpenCV 的标志放到另一幅图像上。

如果我使用加法，颜色会改变，如果使用混合，会得到透明效果，但是我不想要透明。

如果他是矩形我可以象上一章那样使用ROI。但是他不是矩形。

但是我们可以通过下面的按位运

算实现：

Created on Sun Jan 5 20:34:30 2014

@author: duan

import cv2

import numpy as np

# 加载图像

img1 = cv2.imread('roi.jpg')

img2 = cv2.imread('opencv_logo.png')

# I want to put logo on top-left corner, So I create a ROI rows,cols,channels = img2.shape roi = img1[0:rows, 0:cols ]

# Now create a mask of logo and create its inverse mask also img2gray = cv2.cvtColor(img2,cv2.COLOR_BGR2GRAY) ret, mask = cv2.threshold(img2gray, 175, 255, cv2.THRESH_BINARY) mask_inv = cv2.bitwise_not(mask)

# Now black-out the area of logo in ROI # 取 roi 中与 mask 中不为零的值对应的像素的值，其他值为 0 # 注意这里必须有 mask=mask 或者 mask=mask_inv, 其中的 mask= 不能忽略 img1_bg = cv2.bitwise_and(roi,roi,mask = mask)

# 取 roi 中与 mask_inv 中不为零的值对应的像素的值，其他值为 0 。

# Take only region of logo from logo image.

img2_fg = cv2.bitwise_and(img2,img2,mask = mask_inv)

# Put logo in ROI and modify the main image dst = cv2.add(img1_bg,img2_fg) img1[0:rows, 0:cols ] = dst

cv2.imshow('res',img1)

cv2.waitKey(0)

cv2.destroyAllWindows()

结果如下。左面的图像是我们创建的掩码。右边的是最终结果。为了帮助大
家理解我把上面程序的中间结果也显示了出来，特别是img1_bg和img2_fg。


UTMoef.

OpenCV Oper)CV

45
更多资源
练习
1. 创建一个幻灯片用来演示一幅图如何平滑的转换成另一幅图（使用函数 cv2.addWeighted）

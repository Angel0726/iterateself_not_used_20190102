<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Logistic回归 例子2 从疝气病症预测病马的存活问题 - 迭代自己</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="iterateself" />
  <meta name="description" content="author: evo comments: true date: 2018-05-10 01:46:24&#43;00:00 layout: post link: http://106.15.37.116/2018/05/10/logistic-sample2/ slug: logistic-sample2 title: &amp;ldquo; wordpress_id: 5499 categories: - 随想与反思 [mathjax] 注：非原创，推荐直接看原文 相关资料 1. 第5章 Logistic回归 需要补充的 aaa MOTIVE aaa 项目要求 使用" />

  <meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.47.1" />


<link rel="canonical" href="http://iterate.site/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/04-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/01-%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E4%B8%8E%E6%96%B9%E6%B3%95/logistic%E5%9B%9E%E5%BD%92-%E4%BE%8B%E5%AD%902-%E4%BB%8E%E7%96%9D%E6%B0%94%E7%97%85%E7%97%87%E9%A2%84%E6%B5%8B%E7%97%85%E9%A9%AC%E7%9A%84%E5%AD%98%E6%B4%BB%E9%97%AE%E9%A2%98/" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">




<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<link href="/dist/even.min.css?v=3.2.0" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">




<meta property="og:title" content="Logistic回归 例子2 从疝气病症预测病马的存活问题" />
<meta property="og:description" content="author: evo comments: true date: 2018-05-10 01:46:24&#43;00:00 layout: post link: http://106.15.37.116/2018/05/10/logistic-sample2/ slug: logistic-sample2 title: &ldquo; wordpress_id: 5499 categories: - 随想与反思 [mathjax] 注：非原创，推荐直接看原文 相关资料 1. 第5章 Logistic回归 需要补充的 aaa MOTIVE aaa 项目要求 使用" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://iterate.site/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/04-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/01-%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E4%B8%8E%E6%96%B9%E6%B3%95/logistic%E5%9B%9E%E5%BD%92-%E4%BE%8B%E5%AD%902-%E4%BB%8E%E7%96%9D%E6%B0%94%E7%97%85%E7%97%87%E9%A2%84%E6%B5%8B%E7%97%85%E9%A9%AC%E7%9A%84%E5%AD%98%E6%B4%BB%E9%97%AE%E9%A2%98/" /><meta property="article:published_time" content="2018-08-03T12:15:19&#43;00:00"/>
<meta property="article:modified_time" content="2018-08-03T12:15:19&#43;00:00"/>
<meta itemprop="name" content="Logistic回归 例子2 从疝气病症预测病马的存活问题">
<meta itemprop="description" content="author: evo comments: true date: 2018-05-10 01:46:24&#43;00:00 layout: post link: http://106.15.37.116/2018/05/10/logistic-sample2/ slug: logistic-sample2 title: &ldquo; wordpress_id: 5499 categories: - 随想与反思 [mathjax] 注：非原创，推荐直接看原文 相关资料 1. 第5章 Logistic回归 需要补充的 aaa MOTIVE aaa 项目要求 使用">


<meta itemprop="datePublished" content="2018-08-03T12:15:19&#43;00:00" />
<meta itemprop="dateModified" content="2018-08-03T12:15:19&#43;00:00" />
<meta itemprop="wordCount" content="656">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Logistic回归 例子2 从疝气病症预测病马的存活问题"/>
<meta name="twitter:description" content="author: evo comments: true date: 2018-05-10 01:46:24&#43;00:00 layout: post link: http://106.15.37.116/2018/05/10/logistic-sample2/ slug: logistic-sample2 title: &ldquo; wordpress_id: 5499 categories: - 随想与反思 [mathjax] 注：非原创，推荐直接看原文 相关资料 1. 第5章 Logistic回归 需要补充的 aaa MOTIVE aaa 项目要求 使用"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">迭代自己</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">最近</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a><a href="/catalog/">
        <li class="mobile-menu-item">完整目录</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">迭代自己</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">最近</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/catalog/">完整目录</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Logistic回归 例子2 从疝气病症预测病马的存活问题</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-08-03 </span>
        
        <span class="more-meta"> 656 words </span>
        <span class="more-meta"> 2 mins read </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> times read </span>
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#随想与反思">- 随想与反思</a></li>
<li><a href="#相关资料">相关资料</a></li>
<li><a href="#需要补充的">需要补充的</a></li>
</ul></li>
<li><a href="#motive">MOTIVE</a></li>
<li><a href="#项目要求">项目要求</a></li>
<li><a href="#项目数据">项目数据</a></li>
<li><a href="#完整代码">完整代码</a></li>
<li><a href="#comment">COMMENT</a></li>
</ul>
</nav>
  </div>
</div>

    
    

    
    <div class="post-content">
      

<hr />

<p>author: evo
comments: true
date: 2018-05-10 01:46:24+00:00
layout: post
link: <a href="http://106.15.37.116/2018/05/10/logistic-sample2/">http://106.15.37.116/2018/05/10/logistic-sample2/</a>
slug: logistic-sample2
title: &ldquo;
wordpress_id: 5499
categories:</p>

<h2 id="随想与反思">- 随想与反思</h2>

<!-- more -->

<p>[mathjax]</p>

<p><strong>注：非原创，推荐直接看原文</strong></p>

<h2 id="相关资料">相关资料</h2>

<p>1.</p>

<p><a href="http://ml.apachecn.org/mlia/logistic-regress/">第5章 Logistic回归</a></p>

<h2 id="需要补充的">需要补充的</h2>

<ul>
<li>aaa</li>
</ul>

<h1 id="motive">MOTIVE</h1>

<ul>
<li>aaa</li>
</ul>

<hr />

<h1 id="项目要求">项目要求</h1>

<p>使用 Logistic 回归来预测患有疝病的马的存活问题。</p>

<p>疝病是描述马胃肠痛的术语。然而，这种病不一定源自马的胃肠问题，其他问题也可能引发马疝病。</p>

<h1 id="项目数据">项目数据</h1>

<p>链接：<a href="https://pan.baidu.com/s/1uU8z1PDg6XxWzhDIy-lSCw">https://pan.baidu.com/s/1uU8z1PDg6XxWzhDIy-lSCw</a> 密码：4scn</p>

<p>病马的训练数据已经给出来了，如下形式存储在文本文件中:</p>

<pre><code>1.000000    1.000000    39.200000   88.000000   20.000000   0.000000    0.000000    4.000000    1.000000    3.000000    4.000000    2.000000    0.000000    0.000000    0.000000    4.000000    2.000000    50.000000   85.000000   2.000000    2.000000    0.000000
2.000000    1.000000    38.300000   40.000000   24.000000   1.000000    1.000000    3.000000    1.000000    3.000000    3.000000    1.000000    0.000000    0.000000    0.000000    1.000000    1.000000    33.000000   6.700000    0.000000    0.000000    1.000000
</code></pre>

<h1 id="完整代码">完整代码</h1>

<pre><code>import matplotlib.pyplot as plt
import numpy as np
</code></pre>

<p>​
​
    def get_data(file_name):
        fs = open(file_name);
        # 获取训练数据
        data = []
        labels = []
        for line in fs.readlines():
            curr_line = line.strip().split(&rsquo;\t&rsquo;)
            line_arr = []
            for i in range(21):
                line_arr.append(float(curr_line[i]))
            data.append(line_arr)
            labels.append(float(curr_line[21]))
        return data,labels</p>

<p>​
​
​
    def sigmoid(inX):
        return 1.0 / (1 + np.exp(-inX))</p>

<p>​
    # 这也是一个随机梯度下降的方法，不过alpha是变动的
    def stoc_gradient_descent1(datas, labels, num_iter=150):
        data_mat = np.mat(datas)
        label_mat = np.mat(labels).transpose()
        row_num, column_num = np.shape(data_mat)
        weights = np.ones((column_num, 1))  # initialize to all ones
        for j in range(num_iter):
            data_index = list(range(row_num))
            for i in range(row_num):
                alpha = 4 / (1.0 + j*row_num + i) + 0.0001  # apha decreases with iteration, does not
                rand_index = int(np.random.uniform(0, len(data_index)))  # go to 0 because of the constant
                h = sigmoid(sum(data_mat[rand_index] * weights))
                error = float(label_mat[rand_index] - h)
                weights = weights + alpha * error * (data_mat[rand_index]).transpose()
                del (data_index[rand_index])
                if j % 10 == 0 and i == 0:
                    print(error)
        return weights</p>

<pre><code>def classify_vec(inX, weights):
    data = np.array(inX)
    prob = sigmoid(sum(data * weights))
    if prob &gt; 0.5:
        return 1.0
    else:
        return 0.0
</code></pre>

<p>​
    def try_colic():
        train_data, train_labels=get_data(&lsquo;horseColicTraining.txt&rsquo;)
        test_data, test_labels=get_data(&lsquo;horseColicTest.txt&rsquo;)</p>

<pre><code>    # 进行训练
    weights = stoc_gradient_descent1(train_data, train_labels, 1000)
    print(weights)
    # 开始测试
    error_count = 0
    row_column=len(test_data)
    for i in range(row_column):
        if int(classify_vec(test_data[i], weights)) != int(test_labels[i]):
            error_count += 1
    error_rate = (float(error_count) / row_column)
    print(&quot;the error rate of this test is: %f&quot; % error_rate)
    return error_rate
</code></pre>

<p>​
    def multi_try_colic(num_tests = 10):
        error_sum = 0.0
        for k in range(num_tests):
            error_sum += try_colic()
        print(&ldquo;after %d iterations the average error rate is: %f&rdquo; % (num_tests, error_sum / float(num_tests)))
        return error_sum</p>

<pre><code>if __name__==&quot;__main__&quot;:
    multi_try_colic()
</code></pre>

<p>输出：</p>

<pre><code>.....略去
after 10 iterations the average error rate is: 0.361194
</code></pre>

<p><strong>不明白，为什么这个错误率会这么高？不是应该会降低吗？而且，我尝试了下，增加num_iter 或者变更alpha，但是这个错误率仍然还是30% 为什么呢？</strong></p>

<hr />

<h1 id="comment">COMMENT</h1>

    </div>

    
    

    
    

    <footer class="post-footer">
      

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/04-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/07-%E9%99%8D%E7%BB%B4%E4%B8%8E%E5%BA%A6%E9%87%8F%E5%AD%A6%E4%B9%A0/knn-%E4%BE%8B%E5%AD%901%E6%A0%B9%E6%8D%AE%E4%BF%A1%E6%81%AF%E9%80%89%E6%8B%A9%E7%BA%A6%E4%BC%9A%E5%AF%B9%E8%B1%A1/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">KNN-例子1：根据信息选择约会对象</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/04-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/01-%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E4%B8%8E%E6%96%B9%E6%B3%95/logistic%E5%9B%9E%E5%BD%92-%E4%BE%8B%E5%AD%901-%E4%BD%BF%E7%94%A8-logistic-%E5%9B%9E%E5%BD%92%E5%9C%A8%E7%AE%80%E5%8D%95%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%8A%E8%BF%9B%E8%A1%8C%E5%88%86%E7%B1%BB/">
            <span class="next-text nav-default">Logistic回归 例子1 使用 Logistic 回归在简单数据集上进行分类</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="iteratelyd@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="http://github.com/iterateself" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/thebegin/activities" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/people/68028070/" class="iconfont icon-douban" title="douban"></a>
  <a href="http://iterate.site/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
    <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2018
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">iterateself</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="/lib/highlight/highlight.pack.js?v=20171001"></script><script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>


<script type="text/javascript" src="/dist/even.min.js?v=3.2.0"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>








</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>11 条件随机场 - 迭代自己</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="iterateself" />
  <meta name="description" content="第11章条件随机场 条件随机场(conditional random field, CRF)是给定一组输入随机变量条件下 另一组输出随机变量的条件概率分布模型，其特点是假" />

  <meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.47.1" />


<link rel="canonical" href="http://iterate.site/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/11-%E6%9D%A1%E4%BB%B6%E9%9A%8F%E6%9C%BA%E5%9C%BA/" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">




<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<link href="/dist/even.min.css?v=3.2.0" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">




<meta property="og:title" content="11 条件随机场" />
<meta property="og:description" content="第11章条件随机场 条件随机场(conditional random field, CRF)是给定一组输入随机变量条件下 另一组输出随机变量的条件概率分布模型，其特点是假" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://iterate.site/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/11-%E6%9D%A1%E4%BB%B6%E9%9A%8F%E6%9C%BA%E5%9C%BA/" /><meta property="article:published_time" content="2018-06-26T19:22:01&#43;00:00"/>
<meta property="article:modified_time" content="2018-06-26T19:22:01&#43;00:00"/>
<meta itemprop="name" content="11 条件随机场">
<meta itemprop="description" content="第11章条件随机场 条件随机场(conditional random field, CRF)是给定一组输入随机变量条件下 另一组输出随机变量的条件概率分布模型，其特点是假">


<meta itemprop="datePublished" content="2018-06-26T19:22:01&#43;00:00" />
<meta itemprop="dateModified" content="2018-06-26T19:22:01&#43;00:00" />
<meta itemprop="wordCount" content="10013">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="11 条件随机场"/>
<meta name="twitter:description" content="第11章条件随机场 条件随机场(conditional random field, CRF)是给定一组输入随机变量条件下 另一组输出随机变量的条件概率分布模型，其特点是假"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">迭代自己</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">最近</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a><a href="/catalog/">
        <li class="mobile-menu-item">完整目录</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">迭代自己</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">最近</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/catalog/">完整目录</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">11 条件随机场</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-06-26 </span>
        
        <span class="more-meta"> 10013 words </span>
        <span class="more-meta"> 20 mins read </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> times read </span>
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#第11章条件随机场">第11章条件随机场</a>
<ul>
<li><a href="#11-1概率无向图模型">11.1概率无向图模型</a></li>
<li><a href="#11-2条件随机场的定义与形式">11.2条件随机场的定义与形式</a></li>
<li><a href="#pw-y-i-x-i-u-24">pw(y I x)=I    (u.24)</a></li>
<li><a href="#11-3条件随机场的概率计算问题">11.3条件随机场的概率计算问题</a></li>
<li><a href="#11-4条件随机场的学习算法">11.4条件随机场的学习算法</a></li>
<li><a href="#11-5条件随机场的预测算法">11.5条件随机场的预测算法</a></li>
<li><a href="#本章概要">本章概要</a></li>
<li><a href="#继续阅读">继续阅读</a></li>
<li><a href="#参考文献">参考文献</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    

    
    <div class="post-content">
      

<h5 id="第11章条件随机场">第11章条件随机场</h5>

<p>条件随机场(conditional random field, CRF)是给定一组输入随机变量条件下 另一组输出随机变量的条件概率分布模型，其特点是假设输出随机变量构成马尔 可夫随机场.条件随机场可以用于不同的预测问题，本书仅论及它在标注问题的 应用.因此主要讲述线性链(linear chain)条件随机场，这时，问题变成了由输 入序列对输出序列预测的判别模型，形式为对数线性模型，其学习方法通常是极 大似然估计或正则化的极大似然估计.线性链条件随机场应用于标注问题是由 Lafferty等人于2001年提出的.</p>

<p>本章首先介绍概率无向图模型，然后叙述条件随机场的定义和各种表示方 法，最后介绍条件随机场的3个基本问题：概率计算问题、学习问题和预测问题.</p>

<h6 id="11-1概率无向图模型">11.1概率无向图模型</h6>

<p>概率无向图模型(probabilistic undirected graphical model),又称为马尔可夫 随机场(Markov random field),是一个可以由无向图表示的联合概率分布.本节 首先叙述概率无向图模型的定义，然后介绍概率无向图模型的因子分解.</p>

<p>11.1.1模型定义</p>

<p>.图(graph)是由结点(node)及连接结点的边(edge)组成的集合.结点和边 分别记作v和e,结点和边的集合分别记作K和£,图记作G = (r,芯).无向图是 指边没有方向的图.</p>

<p>概率图模型(probabilistic graphical model)是由图表示的概率分布.设有联 合概率分布P(K), re J是一组随机变量.由无向图G = (F，£)表示概率分布 p(7),即在图G中，结点ver表示一个随机变量尺，y =(rxF；边表示 随机变量之间的概率依赖关系.</p>

<p>给定一个联合概率分布P(y)和表示它的无向图G.首先定义无向图表示的 随机变量之间存在的成对马尔可夫性(pairwise Markov property)、局部马尔可夫 性(local Markov property)和全局马尔可夫性(global Markov property).</p>

<p>成对马尔可夫性：设m和v是无向图G中任意两个没有边连接的结点，结点 «和V分别对应随机变量yB和.其他所有结点为o,对应的随机变量组是，.成 对马尔可夫性是指给定随机变量组的条件下随机变量和是条件独立的，即</p>

<p>P(YU,YV\YO)=P(YU\ yo)p(yv\yo)    (n.1)</p>

<p>局部马尔可夫性：设veK是无向图G中任意一个结点，FF是与v有边连接 的所有结点，是v,眾以外的其他所有结点.v表示的随机变量是rv, 表示 的随机变量组是；，O表示的随机变量组是ye.局部马尔可夫性是指在给定随 机变量组&amp;的条件下随机变量I；与随机变量组乙是独立的，即</p>

<p>P(yv,Yo\Yw) = P{Yv\Yw)P{Y0\Yw)    (11.2)</p>

<p>在汽7。|‘)&gt;0时，等价地，</p>

<p>P{YV\YV) = P{YV\YW,YO)    (11.3)</p>

<p>图11.1表示由式(11.2)或式(11.3)所示的局部马尔可夫性.</p>

<p>全局马尔可夫性：设结点集合儿5是在无向图G中被结点集合C分开的任 意结点集合，如图11.2所示.结点集合儿5和C所对应的随机变量组分别是, I；和rc •全局马尔可夫性是指给定随机变量组rc条件下随机变量组和ys是条 件独立的，即</p>

<p>上述成对的、局部的、全局的马尔可夫性定义是等价的⑵.</p>

<p>下面定义概率无向图模型.</p>

<p>定义11.1(概率无向图模型)设有联合概率分布p&reg;,由无向图＜?=(r,£) 表示，在图g中，结点表示随机变量，边表示随机变量之间的依赖关系.如果联 合概率分布p&reg;满足成对、局部或全局马尔可夫性，就称此联合概率分布为概 率无向图模型(probability undirected graphical model),或马尔可夫随机场(Maricov random field).</p>

<p>以上是概率无向图模型的定义，实际上，我们更关心的是如何求其联合概率 分布.对给定的概率无向图模型，我们希望将整体的联合概率写成若干子联合概 率的乘积的形式，也就是榨联合概率进行因子分解，这样便于模型的学习与计 算.事实上，概率无向图模&amp;的最大特点就是易于因子分解.下面介绍这一结果.</p>

<p>11.1.2概率无向图模型的因子分解</p>

<p>首先给出无向图中的团与最大团的定义.</p>

<p>定义11.2 (团与最大团)无向图G中任何两个结点均有边连接的结点子集 称为团(clique).若C是无向图G的一个团，并且不能再加进任何~个0的结点 使其成为一个更大的团，则称此C为最大团(maximal clique).</p>

<p>图11.3表示由4个结点组成的无向图.图中由2个结点组成的团有5个:卬忑}， {Y2,Y3}, {y3,y4} , 和{Uh 有 2 个最大团:{nrj和{y2，y3，y4} •而</p>

<p>不是一个团，因为和?;没有边连接.</p>

<p>图11.3无向图的团和最大团</p>

<p>将概率无向图模型的联合概率分布表示为其最大团上的随机变量的函数的 乘积形式的操作，称为概率无向图模型的因子分解(factorization).</p>

<p>给定概率无向图模型，设其无向图为G，C为G上的最大团，yc表示C对 应的随机变量.那么概率无向图模型的联合概率分布p(y)可写作图中所有最大 团C上的函数的乘积形式，即</p>

<p>彻：去!K(yc)    (1L5)</p>

<p>z c</p>

<p>其中，Z是规范化因子(normalization factor),由式</p>

<p>给出.规范化因子保证P(7)构成一个概率分布.函数!称为势函数(potential function).这里要求势函数&amp;(Fc)是严格正的，通常定义为指数函数••</p>

<p>^c(yc) = exp{-£(yc)}    (11-7)</p>

<p>概率无向图模型的因子分解由下述定理来保证.</p>

<p>定理11.1 (Hammersley-Clifford定理)概率无向图模型的联合概率分布</p>

<p>P(K)可以表示为如下形式：</p>

<p>P(n=^n^(rc)</p>

<p>Z = XU^(Yc)</p>

<p>r c</p>

<p>其中，c是无向图的最大团，&amp;是c的结点对应的随机变量，&amp;(re)是c■上定 义的严格正函数，乘积是在无向图所有的最大团上进行的.    ■</p>

<h6 id="11-2条件随机场的定义与形式">11.2条件随机场的定义与形式</h6>

<p>1111条麵机场的定义</p>

<p>条件随机场(conditional random field)是给定随机变量X条件下，随机变量 X的马尔可夫随机场.这里主要介绍定义在线性链上的特殊的条件随机场，称为 线性链条件随机场(linear chain conditional random field).线性链条件随机场可以 用于标注等问题.这时，在条件概率模型P(y|Z)中，X是输出变量，表示标记 序列，Z是输入变量，表示需要标注的观测序列.也把标记序列称为状态序列(参 见隐马尔可夫模型).学习时，利用训练数据集通过极大似然估计或正则化的极大 似然估计得到条件概率模型戶预测时，对于给定的输入序列x,求出条 件概率內j | x)最大的输出序列夕.</p>

<p>首先定义一般的条件随机场，然后定义线性链条件随机场.</p>

<p>定义11.3 (条件随机场)设x与r是随机变量，_p(y|x)是在给定义的条 件下y的条件概率分布.若随机变量y构成一个由无向图G=(v,E)表示的马尔 可夫随机场，即</p>

<p>P(YV IX,Yw,w^ v) = P(YV \X,Yw,W~v)    (11.8)</p>

<p>对任意结点v成立，则称条件概率分布p(r|jr)为条件随机场.式中表示在 图G =(r,£)中与结点V有边连接的所有结点w, w* v表示结点v以外的所有结 点，尺，&amp;与5；为结点v，u与w对应的随机变量.</p>

<p>在定义中并没有要求义和7具有相同的结构.现实中，一般假设7和F有相 同的图结构.本书主要考虑无向图为如图11.4与图11.5所示的线性链的情况，即</p>

<p>G = (F = {1,2,-£ = {(/,/ + 1)}). / =</p>

<p>在此情况下，X = (Xl,X2, -,XH), y =(y1,y2, -,y„),最大团是相邻两个结点的 集合.线性链条件随机场有下面的定义.</p>

<p>X=(七，X2，.&ldquo;，JVJ</p>

<p>图11.4线性链条件随机场</p>

<p>Xi X2 xt    x„</p>

<p>图11.5义和F有相同的图结构的线性链条件随机场</p>

<p>定义11.4 (线性链条件随机场〉设…，义)，y=(!；，}；，• ••，}；)均 为线性链表示的随机变量序列，若在给定随机变量序列Z的条件下，随机变量序 列r的条件概率分布P(F|X)构成条件随机场，即满足马尔可夫性</p>

<p>» = 1,2,-,« (在f = l和n时只考虑单边〉    (11.9)</p>

<p>则称P(r|Z)为线性链条件随机场.在标注问题中，％表示输入观测序列，F表 示对应的输出标记序列或状态序列.</p>

<p>11.2.2条件随机场的参数化形式</p>

<p>根据定理U.1,可以给出线性链条件随机场p(y)；o的因子分解式，各因子 是定义在相邻两个结点上的函数.</p>

<p>定理11.2 (线性链条件随机场的参数化形式)设P(F|X)为线性链条件随 机场，则在随机变量AT取值为;c的条件下，随机变量y取值为y的条件概率具有 如下形式：</p>

<p>其中，</p>

<p>Z(x) = 2^exp|    + ZAsz(Jz»x»O I    (11.11)</p>

<p>y \i,*    U    )</p>

<p>式中，~和~是特征函数，人和舛是对应的权值.ZCv)是规范化因子，求和是 在所有可能的输出序列上进行的.    ■</p>

<p>式(11.10)和式(11.11)是线性链条件随机场模型的基本形式，表示给定输入 序列对输出序列y预测的条件概率.式(11.10)和式(11.11)中&amp;是定义在边 上的特征函数，称为转移特征，依赖于当前和前一个位置，~是定义在结点上的 特征函数，称为状态特征，依赖于当前位置.r*和&amp;都依赖于位置，是局部特征 函数.通常，特征函数~和~取值为1或0;当满足特征条件时取值为1,否则 为0.条件随机场完全由特征函数&amp; ,力和对应的权值&rsquo;，舛确定.</p>

<p>线性链条件随机场也是对数线性模型(log linear model).</p>

<p>下面看一个简单的例子.</p>

<p>例n.i设有一标注问题：输入观测序列为AT = {Xt,X2,X3),输出标记序列 为 r=(i;，r2，r3)，nr3 取值于 y={i，2}.</p>

<p>假设特征4，S,和对应的权值&rsquo;，/＜如下：</p>

<p>&lsquo;1 =    = 1，只=2，x，f), J = 2,3 ,    =1</p>

<p>这里只注明特征取值为1的条件，取值为0的条件省略，即</p>

<p>之他，—2’3)</p>

<p>下同.</p>

<table>
<thead>
<tr>
<th>f    =1，少2 :1，又，2)</th>
<th></th>
<th>= 0.5</th>
</tr>
</thead>

<tbody>
<tr>
<td>h =吻2 =2&gt;y3 =i»*.3)</td>
<td></td>
<td>=1</td>
</tr>

<tr>
<td>h =/4(Z =2,y2=l,x,2),</td>
<td>A=1</td>
<td></td>
</tr>

<tr>
<td>h =(s(^2 =2，y3 =2，x，3)，</td>
<td>V</td>
<td>= 0.2</td>
</tr>

<tr>
<td></td>
<td>a,:</td>
<td>=1</td>
</tr>

<tr>
<td>s2=s2(y,:=2,x,i&rsquo;), i = l,2</td>
<td></td>
<td>= 0.5</td>
</tr>

<tr>
<td>53=53(Ji=1»^0» i = 2,3</td>
<td></td>
<td>= 0.8</td>
</tr>

<tr>
<td>s4=s4(y3=：2&gt;x,3),</td>
<td></td>
<td>= 0.5</td>
</tr>
</tbody>
</table>

<p>对给定的观测序列JV，求标记序列为y = (^lty2,y3) = (1,2,2)的非规范化条件概率 (即没有除以规范化因子的条件概率).</p>

<p>解由式(11.10),线性链条件随机场模型为</p>

<p>[S    3    4    3</p>

<p>i=l    1=2    t=l    /=1    .</p>

<p>对给定的观测序列x，标记序列:v = (1,2,2)的非规范化条件概率为 P(y, = l，y2 = 2, j3 = 21 x) ec exp (3.2)</p>

<p>11.2.3条件随机场的简化形式</p>

<p>条件随机场还可以由简化形式表示.注意到条件随机场式(11.10)中同一特征 在各个位置都有定义，可以对同一个特征在各个位置求和，将局部特征函数转化 为一个全局特征函数，这样就可以将条件随机场写成权值向量和特征向量的内积 形式，即条件随机场的简化形式.</p>

<p>为简便起见，首先将转移特征和状态特征及其权值用统一的符号表示.设有 个转移特征，尺2个状态特征，足=尽+尺2,记</p>

<p>4U-i，Z，A,)，    k=l,2,—,Kx</p>

<p>s,(yi，x,i), k = Kt +1; l =    -</p>

<p>•，毛</p>

<p>然后，对转移与状态特征在各个位置i•求和，记作</p>

<p>(11.13)</p>

<p>人(＞，工)=只，x，f)，允=1，2，&rdquo;•，尺 i=i</p>

<p>用％表示特征人(j，x)的权值，即</p>

<p>卜，卜1，2,…人 * U, k = KJ+l-,l = l,2,-,K2</p>

<p>于是，条件随机场(11.11)〜(11.12)可表示为 1 K</p>

<p>P(y I x)=^7TexPS    (H 15)</p>

<p>2(x) = exp 2 wtfk (y, x)    (11.16)</p>

<p>y *=1</p>

<p>若以W表示权值向量，即</p>

<p>W =(叫,w2，…，wJT    (11.17)</p>

<p>以尸(j，x)表示全局特征向量，即</p>

<p>则条件随机场可以写成向量w与F(y，;c)的内积的形式:</p>

<p>Pw(y\x)=</p>

<p>exp(w•尸(y，*))</p>

<p>(11.19)</p>

<p>其中，</p>

<p>(11.20)</p>

<p>Zw(x) = EexP(w.F(^))</p>

<p>y</p>

<p>11.2.4条件随机场的矩阵形式</p>

<p>条件随机场还可以由矩阵表示.假设Pw(j|；c)是由式(11.15)〜(11.16)给出 的线性链条件随机场，表示对给定观测序列;t，相应的标记序列y的条件概率.引 进特殊的起点和终点状态标记凡=start,八+| =stop,这时Pw(y|x)可以通过矩阵形 式表示.</p>

<p>对观测序列x的每一个位置» = 1,2,-,«+1,定义一个m阶矩阵(m是标记y, 取值的个数)</p>

<p>=    (11.21)</p>

<p>紙(U, I x) = exp(^(x-_„X |^))    (11.22)</p>

<p>w, (y,.i ,yi\x) = ^wkfk(x_i ,y„x, i)    (11.23)</p>

<p>/=i</p>

<p>这样，给定观测序列x,标记序列&gt;■的非规范化概率可以通过《 + 1个矩阵的 乘积11二1紙0^-1，乃I<em>)表示，于是，条件槪率■PwCv|</em>)是</p>

<h6 id="pw-y-i-x-i-u-24">pw(y I x)=I    (u.24)</h6>

<p>其中，Zw(_x)为规范化因子，是《+1个矩阵的乘积的(start,stop)元素：</p>

<p>Zw(x) =(A/1(xX2(x).-Jl/B+I(x))start&gt;iop    (11.25)</p>

<p>注意，JD= start与stop表示开始状态与终止状态，规范化因子Zw(;c)是 以start为起点stop为终点通过状态的所有路径乃乂…乂的非规范化概率 11:蚌(JW，乃W之和.下面的例子说明了这一事实.</p>

<p>例11.2给定一个由图11.6所示的线性链条件随机场，观测序列x,状态序 列少，j = l,2,3 , « = 3，标记 y,e{l，2},假设 _y0 = start = 1, y4 = stop = 1,各个 位置的随机矩阵叫⑶，A/2(x) , M3(x) , A/4(x)分别是</p>

<p>綱=$ 了，M2(x) =</p>

<p>b2i b22</p>

<p>P °1 |_1 0」</p>

<p>A/3(x) =卜叫，M,(x) =</p>

<p>LC21 C22」</p>

<p>试求状态序列y以start为起点stop为终点所有路径的非规范化概率及规范化 因子.</p>

<p>解首先计算图 11.6 中从start 到 stop 对应于y = (1,1，1)，y=(l,l,2), - , y = (2,2,2)各路径的非规范化概率分别是</p>

<p>&rsquo; a0lbl2C21，aoA2C22</p>

<p>^02^21^1 *    a02^2lCl2 &lsquo;    a02^22C21 &rsquo;    °02^22C22</p>

<p>然后按式(11.25)求规范化因子.通过计算矩阵乘积紙0：)似2(1)；1/3&amp;)似4^ 可知，其第1行第1列的元素为</p>

<p>0oAlCll +    + aoA2C2i + amf312C12</p>

<ul>
<li>aoAlC12 + a&lt;aPl\C\l aoA2C22 + a&lt;a^22C2l</li>
</ul>

<p>恰好等于从start到stop的所有路径的非规范化概率之和，即规范化因子Z(x). ■</p>

<p>图11.6状态路径</p>

<h6 id="11-3条件随机场的概率计算问题">11.3条件随机场的概率计算问题</h6>

<p>条件随机场的概率计算问题是给定条件随机场p(r|；Q,输入序列x和输出 序列计算条件概率p(i＞只|小以及相应的数学期望 的问题.为了方便起见，像隐马尔可夫模型那样，引进前向-后向向量，递归地 计算以上概率及期望值.这样的算法称为前向-后向算法.</p>

<p>11.3.1前向-后向算法</p>

<p>对每个指标!…，《 + 1，定义前向向量a,(X):</p>

<p>/ ,、 fl, y = start</p>

<p>灿W = i0, 4则    (1调</p>

<p>递推公式为</p>

<p>U I ■«) = ai-iU-i I X)M,U-i,y,\x), i = l，2，&rdquo;，” + l (11.27)</p>

<p>又可表示为</p>

<p>&lt;(x) = ^.1(x)Afi(x)    (11.28)</p>

<p>aMx)表示在位置f的标记是乃并且到位置的前部分标记序列的非规范化概 率，乃可取的值有个，所以azCc)是m维列向量.</p>

<p>同样，对每个指标/ = 0，1，.&ldquo;，《 + 1，定义后向向量彦(x):</p>

<p>=(11+29)</p>

<p>AUk)=凤(Md    (11.30)</p>

<p>又可表示妁</p>

<p>P,{x) = Mm (x)^.+1(x)    (11.31)</p>

<p>PMx)表示在位置的标记为y,并且从f + 1到《的后部分标记序列的非规范化 概率.</p>

<p>由前向-后向向量定义不难得到：</p>

<p>z(x) =aJ(x).l = lT./y,(x)</p>

<p>这里，1是元素均为1的m维列向量.</p>

<p>11.3.2概率计算</p>

<p>按照前向-后向向量的定义，很容易计算标记序列在位置是标记的条件概 率和在位置f -1与i是标记和只的条件概率：</p>

<p>^=y, lx) =必⑦U 卜)    (11.32)</p>

<p>14舰 |X)    (11.33)</p>

<p>其中，</p>

<p>Z(x) = a:(x).l</p>

<p>11.3.3期望值的计算</p>

<p>利用前向-后向向量，可以计算特征函数关于联合分布P(y)和条件分布 P(Y\X)的数学期望.</p>

<p>特征函数乂关于条件分布p(r| Z)的数学期望是</p>

<p>(=1 yi.,y,</p>

<p>k = l,2,-,K    (11.34)</p>

<p>其中，</p>

<p>Z(x) = a；(x).l</p>

<p>假设经验分布为p(x),特征函数人关于联合分布p(z，y)的数学期望是 EPix,rW = 2P(X，■^胁m，W)</p>

<p>=Z 戶(X)Z    I 工)玄 乂 Uw，0</p>

<p>x    y    i=l</p>

<p>*    y^i    ^\x)</p>

<p>k = l,2,&ndash;,K    (11.35)</p>

<p>其中，</p>

<p>Z(x) = «J(x).l</p>

<p>式(11.34)和式(11.35)是特征函数数学期望的一般计算公式.对于转移特征 咖七又⑽,* = 1，2,…，X,，可以将式中的人换成/*;对于状态特征，可以将 式中的 乂换成&amp;，表示为 j,(j»,，x，z&rsquo;)，k = Kt +1, J=1,2,&mdash;,K2.</p>

<p>有了式(11.32)〜式(11.35)，对于给定的观测序列a:与标记序列y,可以通 过一•次前向扫描计算a,•及ZCc),通过一次后向扫描计算戏，从而计算所有的概 率和特征的期望.</p>

<h6 id="11-4条件随机场的学习算法">11.4条件随机场的学习算法</h6>

<p>本节讨论给定训练数据集估计条件随机场模型参数的问题，即条件随机场的 学习问题.条件随机场模型实际上是定义在时序数据上的对数线形模型，其学习</p>

<p>方法包括极大似然估计和正则化的极大似然估计.具体的优化实现算法有改进的 迭代尺度法US、梯度下降法以及拟牛顿法(参阅附录A和附录B).</p>

<p>11.4.1改进的迭代尺度法</p>

<p>已知训练数据集，由此可知经验概率分布戶可以通过极大化训练数 据的对数似然函数来求模型参数.</p>

<p>训练数据的对数似然函数为</p>

<p>£(w) = L^PV) = logJJPw(j| x)^ = 2Ax,J)logPw(j|x)</p>

<p>当^是一个由式(11.15)和式(11.16)给出的条件随机场模型时，对数似然函数为</p>

<p>£(w) =</p>

<p>=E|    wkfk    - p(x,j)iogzw(x)l</p>

<p>改进的迭代尺度法通过迭代的方法不断优化对数似然函数改变量的下界，达 到极大化对数似然函数的目的.假设模型的当前参数向量为W=(Wl，W2，…， 向量的增量为&lt;y=(九么，…，4)T,更新参数向量为祕+«^(叫+屯％+么，…， WK+SK)\在每步迭代过程中，改进的迭代尺度法通过依次求解式(11.36)和 式(11.37),得到多=涓,式，…，么)T.推导可参考本书6.3.1节.</p>

<p>l = l,2,-,K2</p>

<p>这里，r(x，y)是在数据(x,y)中出现所有特征数的总和：</p>

<p>T(x，y) = X/<a href="#bookmark7">1</a>Cv&gt;x)=    (11.38)</p>

<p>k    <a href="#bookmark7">1</a>-l i-1</p>

<p>算法11.1 (条件随机场模型学习的改进的迭代尺度法)</p>

<p>输入：特征函数…，^，sits2,&mdash;,sKi ；经验分布戶(x，y);</p>

<p>输出：参数估计值A;模型弋.</p>

<p>&lt;1)对所有^{1，2,…,K}，取初值％=0</p>

<p>在式(11.36)和式(11.37)中，r(x，7)表示数据(x，y)中的特征总数，对不同的</p>

<p>数据CO取值可能不同.为了处理这个问题，定义松弛特征</p>

<p>s(x,y) = 5 -    (11.39)</p>

<p>式中S是一个常数.选择足够大的常数S使得对训练数据集的所有数据(x,y), j(x，y)&gt;0成立.这时特征总数可取S.</p>

<p>由式(11.36),对于转移特征式的更新方程是</p>

<p>Z 戶I    exp(明= Ef,<a href="11.40">tk</a></p>

<p>*.y    i-i</p>

<p>(11.41)</p>

<p>其中,</p>

<p>同样由式(11.37)，对于状态特征么的更新方程是</p>

<p>2 戶I    exp(^ +,5) = £<sup class="footnote-ref" id="fnref:11-43"><a href="#fn:11-43">0</a></sup></p>

<p>x,y    i=l</p>

<p>其中，</p>

<p>(11.44)</p>

<p>£, w=E戶wts&gt;fe、,o    (11.45)</p>

<p>X    l=i y,    ^(X)</p>

<p>以上算法称为算法s.在算法s中需要使常数s取足够大，这样一来，每步 迭代的増量向量会变大，算法收敛会变慢.算法T试图解决这个问题.算法T对 每个观测序列x计算其特征总数最大值7\x):</p>

<p>T{x) = max T(x,y)</p>

<p>(11.46)</p>

<p>y</p>

<p>利用前向-后向递推公式，可以很容易地计算r(；o=h</p>

<p>这时，关于转移特征参数的更新方程可以写成：</p>

<p>=Z ^(x)ZpCf|x)24U-i ,y„x,i) exp(式 r(x))</p>

<p>= -0</p>

<p>香A    (11.47)</p>

<p>这里，气,是特征4的期待值，么=log戎.及是多项式方程(11.47)唯一的实根, 可以用牛顿法求得.从而求得相关的么.</p>

<p>同样，关于状态特征的参数更新方程可以写成：</p>

<p>灿&rsquo;]=s 户(x)pCH *)玄〜Cw&rdquo;)exp(«^i+,r⑻)</p>

<p>x,y    /=i</p>

<p>=崎XCw)exp(么,+,r(x)) =[戶蝴，&rsquo;exP(《&rdquo;)</p>

<p><img src="2012.4e2a-77.jpg" alt="img" /></p>

<p>这里，~是特征~的期望值，&lt;5i=logz,,    是多项式方程(11.48)唯一的实根，</p>

<p>也可以用&rsquo;牛顿法求得.</p>

<p>11.4.2拟牛顿法</p>

<p>条件随机场模型学习还可以座用牛顿法或拟牛顿法(参阅附录B).对于条件 随机场模型</p>

<p>exp</p>

<p>^|x)=—士-4    (11.49)</p>

<p>学习的优化目标函数是</p>

<p>/(w)=wMx&gt;y)j-^//(x&gt;y) (nso)</p>

<p>其梯度函数是</p>

<p>g(w) = ^P{.x)Pv{y\ x)f(x,y)~ £//)    (11.51)</p>

<p>拟牛顿法的BFGS算法如下.</p>

<p>算法11.2 (条件随机场模型学习的BFGS算法)</p>

<p>输入:特征函数/，/2，…，乂；经验分布Pcy,y);</p>

<p>输出：最优参数值必：最优模型巧(/|；0.</p>

<p>(1)    选定初始点ww，取B。为正定对称矩阵，置&amp; = 0</p>

<p>(2)    计算g^gbvW).若g*=0,则停止计算；否则转(3)</p>

<p>(3)    由达凡=-g*求出凡</p>

<p>(4)    一维搜索：求為使得</p>

<p>f(w(i) + ^P*) = ^n/(ww +2pt)</p>

<p>(5)    置 W(*+1&gt;=ww + APi</p>

<p>(6)    计算&amp;M=g(W+l&gt;)，若g*=0,则停止计算；否则，按下式求出私+|，</p>

<p>BM=Bk +</p>

<p>yd B站 Bk yTA ^Bksk</p>

<p>其中，</p>

<p>凡=gw - gt，氏=W(*+I)-Ww</p>

<p>(7) S.k = k+1,转(3).</p>

<h6 id="11-5条件随机场的预测算法">11.5条件随机场的预测算法</h6>

<p>条件随机场的预测问题是给定条件随机场尸(r i X)和输入序列(观测序列);c， 求条件概率最大的输出序列(标记序列)/，即对观测序列进行标注.条件随机 场的预测算法是著名的维特比算法(参阅本书10.4节).</p>

<p>由式(11.19)可得：</p>

<p>/=argmax^,O/[x)</p>

<p>= argmaxekp(-</p>

<p>&lsquo;Zw(x)</p>

<p>=arg max exp(w. F(y, x))</p>

<p>y</p>

<p>=arg max(w. F(y, x))</p>

<p>y</p>

<p>于是，条件随机场的预测问题成为求非规范化概率最大的最优路径问题</p>

<p>max {w.F{y,xy)    (11.52)</p>

<p>这里，路径表示标记序列.其中，</p>

<p>W=(WpW2，…，Wr)T</p>

<p>F(y&gt;    *)，…:人 0^))T</p>

<p>A(y&gt; *) = J A UW，0，k=l,2,&ndash;,K</p>

<p>i=i</p>

<p>注意，这时只需计算非规范化概率，而不必计算概率，可以大大提髙效率.为了 求解最优路径，将式(11.52)写成如下形式：</p>

<p>max    (11.53)</p>

<p>y i=i</p>

<p>其中，</p>

<p>Fh，j,/»x)=(ZU-i，:•)，/2 U-i，z，V)，…，A U-i, J,，x，0)T 是局部特征向量.</p>

<p>下面叙述维特比算法.首先求出位置1的各个标记J = l，2,…，m的非规范化 概率:</p>

<p>^i(7)= w^iCVo = start,yx = j,x), j = l,2,■■■,/»    (11.54)</p>

<p>一般地，由递推公式，求出到位置》•的各个标记/ = 1，2,…，m的非规范化概率的最 大值，同时记录非规范化概率最大值的路径</p>

<p>^«(0 = ,^,{^-1 O&rsquo;) +    (7(_, = j, y, = 1,X)} , / = l，2，”，m    (11.55)</p>

<p>y^(Z) = argmaK|{^_l(7)+    = j,yt = Z,x)}» 1 = 1,2,(11.56)</p>

<p>直到f = n时终止.这时求得非规范化概率的最大值为</p>

<p>max(w»F(y,x)) = m^c 5n{j)    (11.57)</p>

<p>及最优路径的终点</p>

<p>式⑺    (H.S8)</p>

<p>由此最优路径终点返回，</p>

<p>y\ =^+.(Jw)• « =    (11.59)</p>

<p>求得最优路径…，乂)T.</p>

<p>综上所述，得到条件随机场预测的维特比算法：</p>

<p>算法113 (条件随机场预测的维特比算法〉</p>

<p>输入：模型特征向量FGsx)和权值向量w,观测序列* =    ，…,x山</p>

<p>输出：最优路径</p>

<p>(1)    初始化</p>

<p>^0&rsquo;) = ^.^(70 = start, yx =j,x), j =</p>

<p>(2)    递推.对f = 2,3,…，《</p>

<p>st(0 =    O&rsquo;)+ w*U-1 =J&gt;y, =“)}， I = 1,2,—,m</p>

<p>^(0 = argn^{«51-iO&rsquo;) +    =j,yt =l,x)}, 1 = 1，2,. •，m</p>

<p>(3)    终止</p>

<p>max(w • F(y, x)) =    (y)</p>

<p>少:=argK⑽</p>

<p>(4)    返回路径</p>

<p>jdM+i)，i = n-l,n-2,—,l</p>

<p>求得最优路径/ = (X,j^，…,y:).    ■</p>

<p>下面通过一个例子说明维特比算法.</p>

<p>例1L3在例11.1中，用维特比算法求给定的输入序列(观测序列〉X对应 的最优输出序列(标记序列)y=(y；,y&rsquo;2,y*).</p>

<p>解特征函数及对应的权值均在例11.1中给出. 现在利用维特比算法求最优路径问题：</p>

<p>3</p>

<p>&lt;=j</p>

<p>(1)初始化</p>

<p>戎(7) = w.AtVo = start,yt = j,x) , 7 = 1,2</p>

<p>/ = 1, &lt;^) = 1, &lt;^(2) = 0.5.</p>

<p>(2)    递推</p>

<p>/ = 2    式(0 = max{«5；(y) + w&gt;F2(j,l,x)}</p>

<p>S2 (1) = max{l + 2j/2,0.5 +<sup>14</sup>&frasl;<sub>4</sub>} = 1.6 » ¥^(1) = 1</p>

<p>&lt;?2(2) = max{1+&gt;?,/［十//252,0.5+/^52} = 2.5， 5f^(2) = l</p>

<p>i = 3    ^3(0 = max{^2(7)+ wF3(j,/,x)}</p>

<p>么(1) = max{1.6 + /zss5,2.5 + ^/3 + /^j3} = 4.3 » ¥y3(l) = 2 ^3(2) = max{1.6 + V, +//^&lt;，2.5 + ^5 +/z4s4} = 3.2, *T3(2) = 1</p>

<p>(3)    终止</p>

<p>max(w • F(y,%)) = max (/) = J3 ⑴=4.3 X = argmax 么(/) = 1</p>

<p>(4)    返回</p>

<p>⑴=2</p>

<p>/=*；(?；) = ^(2) = 1</p>

<p>最优标记序列</p>

<p>/= (/，％，％) = (1,2,1) ■</p>

<h6 id="本章概要">本章概要</h6>

<p>1.概率无向图模型是由无向图表示的联合概率分布.无向图上的结点之间 的连接关系表示了联合分布的随机变景集合之间的条件独立性，即马尔可夫 性.因此，概率无向图模型也称为马尔可夫随机场.</p>

<p>概率无向图模型或马尔可夫随机场的联合概率分布可以分解为无向图最大 团上的正值函数的乘积的形式.</p>

<p>\2.    条件随机场是给定输入随机变量尤条件下，输出随机变量7的条件概率 分布模型，其形式为参数化的对数线性模型.条件随机场的最大特点是假设输出 变量之间的联合概率分布构成概率无向图模型，即马尔可夫随机场.条件随机场 是判别模型.</p>

<p>\3.    线性链条件随机场是定义在观测序列与标记序列上的条件随机场.线性 链条件随机场一般表示为给定观测序列条件下的标记序列的条件概率分布，由参 数化的对数线性模型表示.模型包含特征及相应的权值，特征是定义在线性链的 边与结点上的.线性链条件随机场的数学表达式是</p>

<p>P(y\x) = ^—exp</p>

<p>\i.k ij J</p>

<p>其中，</p>

<p>2(x) = ^exp    (j(_,,y(,x,/) +    (y,,x,/)</p>

<p>y Vi,*    U    J</p>

<p>\4.    线性链条件随机场的概率计算通常利用前向-后向算法.</p>

<p>\5.    条件随机场的学习方法通常是极大似然估计方法或正则化的极大似然估 计，即在给定训练数据下，通过极大化训练数据的对数似然函数以估计模型参 数.具体的算法有改进的迭代尺度算法、梯度下降法、拟牛顿法等.</p>

<p>\6.    线性链条件随机场的一个重要应用是标注.维特比算法是给定观测序列 求条件概率最大的标记序列的方法.</p>

<h6 id="继续阅读">继续阅读</h6>

<p>关于概率无向图模型可以参阅文献［1,2］.关于条件随机场可以参阅文献［3,41. 在条件随机场提出之前己有最大熵马尔可夫模型等模型被提出［5\条件随机场可 以看作是最大熵马尔可夫模型在标注问题上的推广.支持向量机模型也被推广到 标注问题上&amp;71.</p>

<p>习 题</p>

<p>11.1写出图11.3中无向图描述的概率图模型的因子分解式.</p>

<p>11.2证明2(x) = &lt;(jr).l = lT •為⑻，其中1是元素均为1的w维列向量. 11.3写出条件随机场模型学习的梯度下降法.</p>

<p>11.4参考图11.6的状态路径图，假设随机矩阵蝉⑻，M2(_x),紙(x), <sup>3</sup>&frasl;<sub>4</sub>(x) 分别是</p>

<p>Af3(x) =</p>

<table>
<thead>
<tr>
<th>t a</th>
<th>，叫0)=[</th>
</tr>
</thead>

<tbody>
<tr>
<td>「0.5 0.5_</td>
<td>1 [</td>
</tr>

<tr>
<td>Lo.6O.4_</td>
<td>I，3f4(x) =</td>
</tr>
</tbody>
</table>

<p>0</p>

<p>，0.3 0.71 0.7 0.3</p>

<p>求以= 2为起点stop = 2为终点的所有路径的状态序列j的概率及概 率最大的状态序列.</p>

<h6 id="参考文献">参考文献</h6>

<p>[1J Bishop M. Pattern Recognition and Machine Learning. Springer-Verlag，2006</p>

<p>[2]    Koller D, Friedman N. Probabilistic Graphical Models: Principles and Techniques. MIT Press, 2009</p>

<p>[3]    Lafferty J, McCallum A, Pereira F. Conditional random fields: probabilistic models for segmenting and labeling sequence data. In: International Conference on Machine Learning, 2001</p>

<p>[4]    Sha F, Pereira F. Shallow parsing with conditional random fields. In: Proceedings of the 2003 Conference of the North American Chapter of Association for Computational Linguistics on Human Language Technology, Vol.l, 2003</p>

<p>[5]    McCallum A, Freitag D, Pereira F. Maximum entropy Maricov models for information extraction and segmentation. In: Proc of the International Conference on Machine Learning, 2000</p>

<p>[6]    Taskar B, Guestrin C, Koller D. Max-margin Markov networks. In: Proc of the NIPS 2003, 2003</p>

<p>[7]    Tsochantaridis I, HofinannT, Joachims T. Support vector machine learning for interdependent and structured output spaces. In: ICML, 2004</p>

<p><a href="#footnote1">1</a></p>

<p>w yw.Pi    ^\x)</p>

    </div>

    
    

    
    

    <footer class="post-footer">
      

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/10-%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">10 隐马尔可夫模型</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/12-%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/">
            <span class="next-text nav-default">12 统计学习方法总结</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="iteratelyd@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="http://github.com/iterateself" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/thebegin/activities" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/people/68028070/" class="iconfont icon-douban" title="douban"></a>
  <a href="http://iterate.site/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
    <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2018
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">iterateself</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="/lib/highlight/highlight.pack.js?v=20171001"></script><script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>


<script type="text/javascript" src="/dist/even.min.js?v=3.2.0"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>








</body>
</html>

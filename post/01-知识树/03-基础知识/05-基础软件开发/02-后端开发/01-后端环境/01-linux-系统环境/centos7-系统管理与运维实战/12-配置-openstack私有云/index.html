<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>12 配置 OpenStack私有云 - 迭代自己</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="iterateself" />
  <meta name="description" content="配置OpenStack翮有云 12.5 12®6小结 第13蠢 相关资料 配置OpenStack翮有云 OpenStack既是一个社区，也是一个项目和一个开源" />

  <meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.47.1" />


<link rel="canonical" href="http://iterate.site/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/03-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/05-%E5%9F%BA%E7%A1%80%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/02-%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/01-%E5%90%8E%E7%AB%AF%E7%8E%AF%E5%A2%83/01-linux-%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83/centos7-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E4%B8%8E%E8%BF%90%E7%BB%B4%E5%AE%9E%E6%88%98/12-%E9%85%8D%E7%BD%AE-openstack%E7%A7%81%E6%9C%89%E4%BA%91/" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">




<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<link href="/dist/even.min.css?v=3.2.0" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">




<meta property="og:title" content="12 配置 OpenStack私有云" />
<meta property="og:description" content="配置OpenStack翮有云 12.5 12®6小结 第13蠢 相关资料 配置OpenStack翮有云 OpenStack既是一个社区，也是一个项目和一个开源" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://iterate.site/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/03-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/05-%E5%9F%BA%E7%A1%80%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/02-%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/01-%E5%90%8E%E7%AB%AF%E7%8E%AF%E5%A2%83/01-linux-%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83/centos7-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E4%B8%8E%E8%BF%90%E7%BB%B4%E5%AE%9E%E6%88%98/12-%E9%85%8D%E7%BD%AE-openstack%E7%A7%81%E6%9C%89%E4%BA%91/" /><meta property="article:published_time" content="2018-06-27T07:24:38&#43;00:00"/>
<meta property="article:modified_time" content="2018-06-27T07:24:38&#43;00:00"/>
<meta itemprop="name" content="12 配置 OpenStack私有云">
<meta itemprop="description" content="配置OpenStack翮有云 12.5 12®6小结 第13蠢 相关资料 配置OpenStack翮有云 OpenStack既是一个社区，也是一个项目和一个开源">


<meta itemprop="datePublished" content="2018-06-27T07:24:38&#43;00:00" />
<meta itemprop="dateModified" content="2018-06-27T07:24:38&#43;00:00" />
<meta itemprop="wordCount" content="18680">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="12 配置 OpenStack私有云"/>
<meta name="twitter:description" content="配置OpenStack翮有云 12.5 12®6小结 第13蠢 相关资料 配置OpenStack翮有云 OpenStack既是一个社区，也是一个项目和一个开源"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">迭代自己</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">最新</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a><a href="/catalog/">
        <li class="mobile-menu-item">完整目录</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">迭代自己</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">最新</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/catalog/">完整目录</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">12 配置 OpenStack私有云</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-06-27 </span>
        
        <span class="more-meta"> 18680 words </span>
        <span class="more-meta"> 38 mins read </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> times read </span>
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  
  <div class="post-toc-content">
    
  </div>
</div>

    
    

    
    <div class="post-content">
      <nav>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#配置openstack翮有云">配置OpenStack翮有云</a></li>
</ul></li>
</ul></li>
<li><a href="#12-5">12.5</a>
<ul>
<li><a href="#12-6小结">12®6小结</a>
<ul>
<li><a href="#第13蠢">第13蠢</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#相关资料">相关资料</a></li>
</ul></li>
</ul>
</nav>

<h6 id="配置openstack翮有云">配置OpenStack翮有云</h6>

<p>OpenStack既是一个社区，也是一个项目和一个开源软件，它提供了一个部署云的操作平 台或工具集。其宗旨在于帮助组织和运行为虚拟计算或存储服务的云，为公有云、私有云，也 为大云、小云提供可扩展的、灵活的云计算。</p>

<p>本章主要涉及的知识点有：</p>

<p>•    OpenStack 概况</p>

<p>•    OpenStack系统架构</p>

<p>•    OpenStack主要部署工具</p>

<p>•通过 RDO 部署 OpenStack</p>

<p>參管理OpenStack</p>

<p>12.1 OpenStack 概况</p>

<p>OpenStack是一个免费的开放源代码的云计算平台，用户可以将其部署成为一个基础设施 即服务（Iaas）的解决方案。OpenStack不是一个单一的项目，而是由多个相关的项目组成， 包括Nova、Swift、Glance、Keystone以及Horizon等。这些项目分别实现不同的功能，例如 弹性计算服务、对象存储服务、虚拟机磁盘镜像服务、安全统一认证服务以及管理平台等。 OpenStack 以 Apache 许可授权。</p>

<p>OpenStack最早开始于2010年，作为美国国家航空航天局和Rackspace合作研发的云端运 算软件项目，目前，OpenStack由OpenStack基金会管理，该基金会是一个非营利组织，创立 于2012年。现在已经有超过200家公司参与了该项目，包括Arista Networks、AT&amp;T、AMD、 Cisco、Delk EMC、HP、IBM、Intel、NEC、NetApp 以及 Red Hat 等大型公司。</p>

<p>OpenStack发展非常迅速，已经发布了 11个版本，每个版本都有代号，分别为Austin、 Bexar、Cactus、Diablo、Essex、Folsom、Grizzly、Havana、Icehouse、Juno 以及最新的 Kilo。</p>

<p>除了 OpenStack之外，还有其他的一些云计算平台，例如Eucalyptus&gt;AbiCloud&gt;OpenNebula 等，这些云计算平台都有自己的特点，关于它们之间具体的区别，请读者参考相关书籍，此处 不再详细说明。</p>

<p>1 2el&rsquo; OpenStack 系统架构</p>

<p>由于OpenStack由多个组件组成，所以其系统架构相对比较复杂。但是，只有了解 OpenStack的系统架构，才能够成功地部署和管理OpenStack。本节将对OpenStack的整体系 统架构进行介绍。</p>

<p>12.2.1 OpenStack 体系架构</p>

<p>OpenStack由多个服务模块构成，表12.1-12.4列出了这些服务模块。</p>

<p>表12.1基本模块</p>

<table>
<thead>
<tr>
<th>项目名称</th>
<th>说明</th>
</tr>
</thead>

<tbody>
<tr>
<td>Horizon</td>
<td>提供了基于Web的控制台，以此来展示OpenStack的功能</td>
</tr>

<tr>
<td>Nova</td>
<td>OpenStack云计算架构的基础项目，是基础架构即服务(IaaS)中的核心模块。它负责 管理在多种Hypervisor上的虚拟机的生命周期</td>
</tr>

<tr>
<td>Neutron</td>
<td>提供云计算环境下的虚拟网络功能</td>
</tr>
</tbody>
</table>

<p>表12.2存储模块</p>

<table>
<thead>
<tr>
<th>项目名称</th>
<th>说明</th>
</tr>
</thead>

<tbody>
<tr>
<td>Swift</td>
<td>提供了弾性可伸缩、髙可用的分布式对象存储服务，适合存储大规模非结构 化数据</td>
</tr>

<tr>
<td>Cinder</td>
<td>提供块存储服务</td>
</tr>
</tbody>
</table>

<p>表12.3共享服务</p>

<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>

<tbody>
<tr>
<td>Keystone</td>
<td>为其他的模块提供认证和授权</td>
</tr>

<tr>
<td>Glance</td>
<td>存储和访问虚拟机磁盘镜像文件</td>
</tr>

<tr>
<td>Ceilometer</td>
<td>为计费和监控以及其他服务提供数据支撑</td>
</tr>
</tbody>
</table>

<p>表12.4其他的服务</p>

<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>

<tbody>
<tr>
<td>Heat</td>
<td>实现弹性扩展，自动部署</td>
</tr>

<tr>
<td>Trove</td>
<td>提供数据库即服务功能</td>
</tr>
</tbody>
</table>

<p>图12.1描述了 OpenStack中各子项目及其功能之间的关系，</p>

<p>第12章配置OpenStack私有云</p>

<p>图12.1各子项目与功能</p>

<p>图12.2描述了 OpenStack各功能模块之间的关系。</p>

<p>12.2.2 OpenStack 部署方式</p>

<p>针对不同的计算、网络和存储环境，用户可以非常灵活地配置OpenStack来满足自己的需</p>

<p>求。图12.3显示了含有3个节点的OpenStack的部署方案。</p>

<p>网络节点 （虚拟网络〉</p>

<p>计算节点 （计算节点1）</p>

<p>控制节点 （控制器）</p>

<table>
<thead>
<tr>
<th>支撑服务</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>数据库服务 MySQL</td>
<td></td>
<td>消息代理 RabbitMQ</td>
<td></td>
</tr>
</tbody>
</table>

<p>身份认证 Keystone</p>

<p>可选服务</p>

<p>块存储管理 Cinder</p>

<p>基本服务</p>

<p>基本服务</p>

<p>镜像文件 Glance</p>

<p>对象存慵 Swift</p>

<p>计算服务 Nova</p>

<p>数据库服务 Trove</p>

<p>网络服务 Neutron</p>

<p>自动化部署 Heat</p>

<p>控制台</p>

<p>Horizon</p>

<p>Telemetry</p>

<p>Ceilometer</p>

<p>网络接口 10.0.0.<sup>11</sup>&frasl;<sub>24</sub></p>

<p>ML2插件 二层代理（OVS）</p>

<p>三层代理 DHCP代理</p>

<p>计算</p>

<p>KVM/QEMU</p>

<p>网络 ML2插件</p>

<p>二层代理（OVS）</p>

<p>可选服务</p>

<p>Telemetry Ceilometer 代理</p>

<p>1.管理：10.0.0.<sup>21</sup>&frasl;<sub>24</sub> | 2.实例通道：10.0.1.<sup>21</sup>&frasl;<sub>2</sub>^~|</p>

<p>3.外部网络接口</p>

<p>网络接口</p>

<p>1.管理：10.0.0.<sup>31</sup>&frasl;<sub>24</sub></p>

<p>2.实例通道：10.0.1.<sup>31</sup>&frasl;<sub>24</sub></p>

<p>图12.3含有3个节点的OpenStack部署方案</p>

<p>在图12.3中，使用Neutron作为虚拟网络的管理模块，包含控制节点、网络节点和计算 节点，这3个节点的功能分别描述如下：</p>

<p>1.控制节点</p>

<p>基本控制节点运行身份认证服务、镜像文件服务、计算节点和网络接口的管理服务、虚拟 网络插件以及控制台等。另外，还运行一些基础服务，例如OpenStack数据库、消息代理以及 网络时间NTP服务等。</p>

<p>控制节点还可以运行某些可选服务，例如部分的块存储管理、对象存储管理、数据库服务、 自动部署（Orchestration）以及 Telemetry （Ceilometer）。</p>

<p>2.网络节点</p>

<p>网络节点运行虚拟网络插件、二层网络代理以及三层网络代理。其中，二层网络服务包括 虚拟网络和隧道技术，三层网络服务包括路由、网络地址转换（NAT）以及DHCP等。此外， 网络节点还负责虚拟机与外部网络的连接。</p>

<p>3.计算节点</p>

<p>计算节点运行虚拟化监控程序（Hypervisor）,管理虚拟机或者实例。默认情况下，计算节 点采用KVM作为虚拟化平台。除此之外，计算节点还可以运行网络插件以及二层网络代理。 通常情况下，计算节点会有多个。</p>

<p>12.2.3计算模块Nova</p>

<p>Nova是OpenStack系统的核心模块，其主要功能是负责虚拟机实例的生命周期管理、网 络管理、存储卷管理、用户管理以及其他的相关云平台管理功能。从能力上讲，Nova类似于 Amazon EC2。Nova逻辑结构中的大部分组件可以划分为以下两种自定义的Python守护进程:</p>

<p>(1)    接收与处理API调用请求的Web服务器网关接口(Python Web Server Gateway Interface, WSGI),例如 Nova-API 和 Glance-API 等。</p>

<p>(2)    执行部署任务的Worker守护进程，例如Nova-Compute&gt; Nova-Network以及 Nova-Schedule 等。</p>

<p>消息队列（Queue）与数据库（Database）作为Nova的架构中的两个重要的组成部分，虽 然不属于WSGI或者Worker进程，但是两者通过系统内消息传递和信息共享的方式实现任务 之间、模块之间以及接口之间的异步部署，在系统层面大大简化了复杂任务的调度流程与模 式，是Nova的核心模块。</p>

<p>由于Nova采用无共享和基于消息的灵活架构，所以Nova的7个组件有多种部署方式。 用户可以将每个组件单独部署到一台服务器上，也可以根据实际情况，将多个组件部署到一台 服务器上。</p>

<p>下面给出了几种常见的部署方式。</p>

<p>\1.    单节点</p>

<p>在这种方式下，所有的Nova服务都集中在一台服务器上，同时也包含虚拟机实例。由于 这种方式的性能不高，所以不适合生产环境，但是部署起来相对比较简单，所以非常适合初学 者练习或者相关开发。</p>

<p>\2.    双3f?点</p>

<p>这种部署方式由两台服务器构成，其中一台作为控制节点，另外一台作为计算节点。控制 节点运行除Nova-Compute服务之外的所有的其他服务，计算节点运行Nova-Compute服务。 双节点部署方式适合规模较小的生产环境或者开发环境。</p>

<p>\3.    多节点</p>

<p>这种部署方式由用户根据业务性能需求，实现多个功能模块的灵活安装，包括控制节点的 层次化部署和计算节点规模的扩大。多节点部署方式适合各种对于性能要求较高的生产环境。</p>

<p>12.2.4分布式对象存储模块Swift</p>

<p>Swift是OpenStack系统中的对象存储模块，其目标是使用标准化的服务器来创建冗余的、 可扩展且存储空间达到PB级的对象存储系统。简单地讲，Swift非常类似于AWS的S3服务。 它并不是传统意义上的文件系统或者实时数据存储系统，而是长期静态数据存储系统。</p>

<p>Swift主要由以下3种服务组成：</p>

<p>(1)    代理服务：提供数据定位功能，充当对象存储系统中的元数据服务器的角色，维护 账户、容器以及对象在环(Ring)中的位置信息，并且向外提供API,处理用户访问请求。</p>

<p>(2)    对象存储：作为对象存储设备，实现用户对象数据的存储功能。</p>

<p>(3)    身份认证：提供用户身份鉴定认证功能。</p>

<p>OpenStack中的对象由存储实体和元数据组成，相当于文件的概念。当向Swift对象存储 系统上传文件的时候，文件并不经过压缩或者加密，而是和文件存放的容器名、对象名以及文 件的元数据组成对象，存储在服务器上。</p>

<p>12.2.5虚拟机镜像管理模块Glance</p>

<p>Glance项目主要提供虚拟机镜像服务，其功能包括虚拟机镜像、存储和获取关于虚拟机 镜像的元数据、将虚拟机镜像从一种格式转换为另外一种格式。</p>

<p>Glance主要包括两个组成部分，分别是Glance API和Glance Registry。Glance API主要提 供接口，处理来自Nova的各种请求。Glance Registry用来和MySQL数据库进行交互，存储 或者获取镜像的元数据。这个模块本身不存储大量的数据，需要挂载后台存储Swift来存放实 际的镜像数据。</p>

<p>12.2.6身份认证模块Keystone</p>

<p>Keystone是OpenStack中负责身份验证和授权的功能模块。Keystone类似一个服务总线， 或者说是整个OpenStack框架的注册表，其他服务通过keystone来注册其服务的端点 (Endpoint),任何服务之间相互的调用，都需要经过Keystone的身份验证，来获得目标服务 的端点来找到目标服务。</p>

<p>Keystone包含以下基本概念：</p>

<p>\1.    用户(User)</p>

<p>用户代表可以通过Keystone进行访问的人或程序。用户通过认证信息如密码、API Keys 等进行验证。</p>

<p>\2.    租户(Tenant)</p>

<p>租户是各个服务中的一些可以访问的资源集合。例如，在Nova中一个租户可以是一些机 器，在Swift和Glance中一个租户可以是一些镜像存储，在Quantum中一个租户可以是一些 网络资源。默认情况下，用户总是绑定到某些租户上面。</p>

<p>3.角色(Role)</p>

<p>角色代表一组用户可以访问的资源权限，例如Nova中的虚拟机、Glance中的镜像。用户 可以被添加到任意一个全局的或租户内的角色中。在全局的角色中，用户的角色权限作用于所 有的租户，即可以对所有的租户执行角色规定的权限；在租户内的角色中，用户仅能在当前租 户内执行角色规定的权限。</p>

<p>\4.    服务（Service ）</p>

<p>OpenStack中包含许多服务，如Nova、Glance、Swift。根据前三个概念，即用户、租户 和角色，一个服务可以确认当前用户是否具有访问其资源的权限。但是当一个用户尝试着访问 其租户内的服务时，该用户必须知道这个服务是否存在以及如何访问这个服务，这里通常使用 一些不同的名称表示不同的服务。</p>

<p>\5.    端点（Endpoint）</p>

<p>所谓端点，是指某个服务的URL。如果需要访问一个服务，则必须知道该服务的端点。 因此，在Keystone中包含一个端点模板，这个模板提供了所有存在的服务的端点信息。一个 端点模版包含一个URL列表，列表中的每个URL都对应一个服务实例的访问地址，并且具有 public、private和admin这三种权限。其中public类型的端点可以被全局访问，私有URL只 能被局域网访问，admin类型的URL被从常规的访问中分离。</p>

<p>12.2.7 控制台 Horizon    、</p>

<p>Horizon为用户提供了一个管理OpenStack的控制面板，使得用户可以通过浏览器，以图 形界面的方式就可以进行相应的管理任务，避免去记忆烦琐、复杂的命令。Horizon几乎提供 了所有的操作功能，包括Nova虚拟机实例的管理和Swift存储管理等。图12.4显示了 Horizon 的主界面，关于Horzon的详细功能，将在后面的内容中介绍。</p>

<p>admin    ;</p>

<p>管理员</p>

<p>I</p>

<p>測机簟職</p>

<p>云谈&amp;</p>

<p>云主机类型</p>

<p>项目名称</p>

<p>admn</p>

<p>3示1个彔目</p>

<p>Q    - OpenStack I</p>

<p>4-    G \ Cl 58.64.138.219/dashboarrt/adm5n/</p>

<p>Q openstack</p>

<p>使用情况摘要</p>

<p>选择的一段吋间来査询其用量：</p>

<p>从 2014-05-01 a. 20105-24    日期采是懶式。</p>

<p>活衽的云主机1活妖的内存：512MB S_时期的的VCPU-小时教：3 63这一时期的GB.小时教：3.63 用量    ▲石载CSV摘要</p>

<p>虚拟内核</p>

<p>内存</p>

<p>512MB</p>

<p>途似内核小时教</p>

<p>3 63</p>

<p>磁盘</p>

<p>1</p>

<p>图12.4 Horizon主界面</p>

<p>12.3 Openstack主要部署工具</p>

<p>前面已经介绍过，OpenStack的体系架构比较复杂，对于初学者来说，逐个使用命令来安 装各个组件是一项非常困难的事情。幸运的是，为了简化OpenStack的安装操作，许多部署工 具已经被开发出来。通过这些工具，用户可以快速地搭建出一个OpenStack的学习环境。本节 将对主要的OpenStack部署工具进行介绍。</p>

<p>12.3.1 Fuel</p>

<p>Fuel是一个端到端一键部署OpenStack设计的工具，主要包括裸机部署、配置管理、 OpenStack组件以及图形界面等几个部分，下面分别进行简单介绍。</p>

<p>1.裸机部署</p>

<p>Fuel支持裸机部署，该项功能由HP的Cobbler提供。Cobbler是一个快速网络安装Linux 的服务，该工具使用python开发，小巧轻便，使用简单的命令即可完成PXE网络安装环境的</p>

<p>配置管理采用P叩pet实现。Puppet是一个非常有名的云环境自动化配置管理工具，采用 XML语言定义配置。Puppet提供了一个强大的框架，简化了常见的系统管理任务，大量细节 交给Puppet去完成，管理员只要集中精力在业务配置上。系统管理员使用Puppet的描述语言 来配置，这些配置便于共享。Puppet伸缩性强，可以管理成千上万台机器。</p>

<p>\3.    OpenStack 组件</p>

<p>除了可灵活选择安装OpenStack核心组件以外，还可以安装Monitoring和HA组件。Fuel 还支持心跳检查。</p>

<p>\4.    图形界面</p>

<p>Fuel提供了基于Web的管理界面Fuel Web,可以使用户非常方便地部署和管理OpenStack 的各个组件。</p>

<p>12.3.2 TripleO</p>

<p>TripleO 是另外_套 OpenStack 部署工具，TripleO 又称为 OpenStack 的 OpenStack (OpenStack OverOpenStack)。通过使用OpenStack运行在裸机上的自有设施作为该平台的基</p>

<p>础，这个项目可以实现OpenStack的安装、升级和操作流程的自动化。</p>

<p>在使用TripleO的时候，需要先准备一个OpenStack控制器的镜像，然后用这个镜像通过</p>

<p>OpenStack的Ironic功能再去部署裸机，再通过HEAT在裸机上部署OpenStack。</p>

<p>12.3.3    RDO</p>

<p>RDO （Red Hat Distribution of OpenStack）是由红帽公司推出的部署 OpenStack 集群的一 个基于Puppet的部署工具，可以很快地通过RDO部署一套复杂的OpenStack环境。如果用户 想在REHL上面部署OpenStack,最便捷的方式就是RDO。在本书中，就是采用RDO来介绍 OpenStack 的安装。</p>

<p>12.3.4    DevStack</p>

<p>DevSteck实际上是个Shell脚本，可以用来快速搭建OpenStack的运行和开发环境，特 别适合OpenStack开发者下载最新的OpenStack代码后迅速在自己的笔记本上搭建一个开发环 境。正如DevStack官方所强调的，devstack不适合用在生产环境。</p>

<p>12.4 通过RDO部署OpenStack</p>

<p>尽管OpenStack已经拥有了许多部署工具，但是在RHEL或者CentOS等操作系统上部署 OpenStack, RDO仍然是首选的方案。尤其对于初学者来说，使用RDO可以大大降低部署的 难度。本节将对使用RDO部署OpenStack进行详细介绍。</p>

<p>12.4.1部署前的准备</p>

<p>OpenStack对于软硬件环境都有一定的要求，其中RHEL是官方推荐的版本，另外，用户 也可以选择其他的基于RHEL的发行版，例如CentOS 6.5及之后的版本（包括CentOS 7）、 Scientific Linux 6.5或者Fedora 20以上。为了避免Packstack域名解析出现问题，需要把主机 名设置为完整的域名，来代替短主机名（注意如果不使用自建的DNS服务器，同时也要修改 /etc/hosts）。</p>

<p>硬件方面，OpenStack至少需要2GB的内存，CPU也需要支持硬件虚拟化，此外，至少 有一块网卡。</p>

<p>12.4.2配置安装源</p>

<p>为了保证当前系统的所有的软件包都是最新的，需要使用yum命令进行更新操作，命令 如下：</p>

<p>[rootQlocalhost 〜3# yum -y update</p>

<p>执行以上命令之后，yum软件包管理器会查询安装源，以验证当前系统中的软件包是否 有更新；如果存在更新，则会自动进行安装。由于系统中的软件包通常会非常多，所以上面的 更新操作可能会花费较长的时间。</p>

<p>接下来是配置OpenStack安装源，目前RDO的最新版本为IceHouse, RedH提供了一个 RPM软件包来帮助用户设置RDO安装源，其URL为：</p>

<p><a href="http://rdo.fedorapeople.org/openstack-icehouseZrdo-release-icehouse.rpm">http://rdo.fedorapeople.org/openstack-icehouseZrdo-release-icehouse.rpm</a></p>

<p>用户只要安装以上软件包即可，命令如下：</p>

<p>[rooteiocalhost -]# yum install -y</p>

<p><a href="http://rdo.fedorapeople.org/openstack-icehouse/rdo-release-icehouse.rpm">http://rdo.fedorapeople.org/openstack-icehouse/rdo-release-icehouse.rpm</a></p>

<p>执行以上命令之后，会为当前系统添加Foreman、Puppet Labs和RDO安装源，命令如下:</p>

<p>[root@localhost -]# 11 /etc/yum.repos.d/</p>

<p>total 32</p>

<p><img src="11 CentOS7fbdfa1060ed0f49e18-262.jpg" alt="img" /></p>

<table>
<thead>
<tr>
<th>-rw-r——r——.1</th>
<th>root</th>
<th>root</th>
<th>707</th>
<th>May</th>
<th>24 14:38</th>
<th>foreman.repo</th>
</tr>
</thead>

<tbody>
<tr>
<td>- rw-r——r——.1</td>
<td>root</td>
<td>root</td>
<td></td>
<td>1220</td>
<td>May 24 14:38</td>
<td></td>
</tr>

<tr>
<td>puppetlabs.repo</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>-rw-r&ndash;r. 1</td>
<td>root</td>
<td>root</td>
<td>248</td>
<td>May</td>
<td>24 14:38</td>
<td>rdo-release.</td>
</tr>
</tbody>
</table>

<p>在正式开始安装之前，还需要妥善处理SELinux和防火墙等，以免安装过程中出现问题或 导致安装完成后无法访问。</p>

<p>12.4.3 安装 Packstack</p>

<p>在使用RDO安装OpenStack过程中，需要Packstack来部署OpenStack,所以，必须提前 安装Packstack软件包。Packstack的底层也是基于Puppet,通过Puppet部署OpenStack各组件。 Packstack的安装命令如下：</p>

<p>[root@localhost # yum -y install openstack-packstack</p>

<p>12.4.4 安装 OpenStack</p>

<p>Packstack提供了多种方式来部署OpenStack,包括单节点和多节点等，其中单节点部署最 简单。单节点部署方式中，OpenStack所有的组件都被安装在同一台服务器上面。用户还可以 选择控制器加多个计算节点的方式或者是其他的部署方式。为了简化操作，本节将选择单节点 部署方式。</p>

<p>Packstack提供了一个名称为packstack的命令来执行部署操作。该命令支持非常多的选项， 用户可以通过以下命令来查看这些选项及其含义：</p>

<p>[root@localhost 〜packstack &ndash;help</p>

<p>从大的方面来说，packstack命令的选项主要分为全局选项、vCenter选项、MySQL选项、 AMQP 选项、Keystone 选项、Glance 选项、Cinder 选项、Nova 选项、Neutron 选项、Horizon 选项、Swift选项、Heat选项、Ceilometer选项以及Nagios选项等。可以看出packstack命令 非常灵活，几乎为所有的OpenStack都提供了相应的选项。下面对常用的选项进行介绍。</p>

<p>\1.    -gen-answer-file</p>

<p>该选项用来创建一个应答文件(answer file),应答文件是一个普通的纯文本文件，包含了 packstack部署OpenStack所需的各种选项。</p>

<p>\2.    -answer-file</p>

<p>该选项用来指定一个已经存在的应答文件，packstack命令将从该文件中读取各选项的值。</p>

<p>\3.    -install-hosts</p>

<p>该选项用来指定一批主机，主机之间用逗号隔开。列表中的第1台主机将被部署为控制节 点，其余的部署为计算节点。如果只提供了一台主机，则所有的组件都将被部署在该主机上面。</p>

<p>\4.    -allinone</p>

<p>该选项用来执行单节点部署。</p>

<p>\5.    -os-mysql-install</p>

<p>该选项的值为y或者n,用来指定是否安装MySQL服务器。</p>

<p>\6.    -os-glance-install</p>

<p>该选项的值为y或者n,用来指定是否安装Glance组件。</p>

<p>\7.    -os-cinder-install</p>

<p>该选项的值为y或者n,用来指定是否安装Cinder组件。</p>

<p>\8.    -os-nova-install</p>

<p>该选项的值为y或者n,用来指定是否安装Nova组件。</p>

<p>\9.    -os-neutron-install</p>

<p>该选项的值为y或者n，用来指定是否安装Neutron组件。</p>

<p>\10. -os-horizon-install</p>

<p>该选项的值为y或者n，用来指定是否安装Horizon组件。</p>

<p>\11. -os-swift-install</p>

<p>该选项的值为y或者n，用来指定是否安装Swift组件。</p>

<p>\12. -os-ceilometer-install</p>

<p>该组件的值为y或者n，用来指定是否安装Ceilometer组件。</p>

<p>除了以上选项之外，对于每个具体的组件，packstack也提供了许多选项，不再详细介绍。 如果用户想在一个节点上面快速部署OpenStack,可以使用-allinone选项，命令如下：</p>

<p>(rootfilocalhost # packstack &ndash;allinone</p>

<p>如果想要单独指定其中的某个选项，例如下面的命令将采用单节点部署，并且虚拟网络 采用 Neutron：</p>

<p>[root@localhost # packstack allinone os-neutron-install-y</p>

<p>由于packstack的选项非常多，为了便于使用，packstack命令还支持将选项及其值写入一 个应答文件(Answer file)中。用户可以通过-gen-answer-file选项来创建应答文件，如下所示：</p>

<p>[root@localhost packstack ^^gen^answer-file openstack.txt</p>

<p>应答文件为一个普通的纯文本文件，&rsquo; 包含了 packstack部署OpenStack所需的各种选项， 如下所示：</p>

<p>[rootSlocalhost 叫# cat openstack.txt J more [general]    &lsquo;</p>

<p>+ ^</p>

<p>#    Path to a Public key to install on servers. If a usable key has not</p>

<p>#    been installed on the remote servers the user will be prompted for a</p>

<p>#    password and this key will be installed so the password will not be</p>

<p>#    required again CONFIG_SSH_KEY=</p>

<p>#    Set to *y1 if you would like Packstack to install MySQL CONF 工 G 一MYSQL_JNSTAL3&gt;y</p>

<p>#    Set to ’y1 if you would like Packstack to install OpenStack Image</p>

<p>#    Service (Glance)    々4 :</p>

<p>CONFlG_GLANCE__INSTALL=y</p>

<p>#    Set to * y1 if you would like Packstack to install OpenStack Block</p>

<p>#    Storage (Cinder)</p>

<p>CONFIG_CINDER_INSTALL-y</p>

<p>用户可以根据自己的需要来修改生成的应答文件，以确定某个组件是否需要安装，以及 相应的安装选项。修改完成之后，使用以下命令进行安装部署：</p>

<p>[root@loealhost 〜H packstack answer-file openstack.txt</p>

<p>如果没有设置SSH密钥，在部署之前，packstack会询问参与部署的各主机的root用户的</p>

<p>密码，用户输入相应的密码即可。下面的代码是部分安装过程:</p>

<table>
<thead>
<tr>
<th>[root@localhost    # packstack    answer-file</th>
<th>openstack‘</th>
<th>txt</th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>Welcome to Installer setup utility</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>Packstack changed given value to required value</td>
<td>/root/.ssh/id一rsa.pub</td>
<td></td>
<td></td>
</tr>

<tr>
<td>Installing:</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>Clean Up</td>
<td>(</td>
<td>DONE</td>
<td>]</td>
</tr>

<tr>
<td>root@58.64.138,2191s password:</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>Setting up ssh keys</td>
<td>(</td>
<td>DONE</td>
<td>1</td>
</tr>

<tr>
<td>Discovering hosts1 details</td>
<td>(</td>
<td>DONE</td>
<td>]</td>
</tr>

<tr>
<td>Adding pre install manifest entries</td>
<td>C</td>
<td>DONE</td>
<td>]</td>
</tr>

<tr>
<td>Adding MySQL manifest entries</td>
<td>[</td>
<td>DONE</td>
<td>]</td>
</tr>

<tr>
<td>Adding AMQP manifest entries</td>
<td>(</td>
<td>DONE：</td>
<td>1</td>
</tr>

<tr>
<td>Adding Keystone manifest entries</td>
<td>fcS餐</td>
<td>DONE</td>
<td>]</td>
</tr>

<tr>
<td>Adding Glance Keystone manifest entries</td>
<td>[</td>
<td>DONE</td>
<td>)</td>
</tr>

<tr>
<td>Adding Glance manifest entries</td>
<td>[</td>
<td>DONE</td>
<td>]</td>
</tr>

<tr>
<td>Installing dependencies for Cinder&hellip;&hellip;</td>
<td>[</td>
<td>DONE</td>
<td>]</td>
</tr>
</tbody>
</table>

<p><img src="11 CentOS7fbdfa1060ed0f49e18-263.jpg" alt="img" /></p>

<p>整个安装过程需费较长的0^,与用户选择的组件、网gpi机的硬＜牛配置情况密q</p>

<p>相关，一般为20-50分钟。如果在安装的过程中，由于网络原因导致安装失败，可以再次 执行以上命令重新安装部署。</p>

<p>当出现以下信息时，表示安装完成:</p>

<p>Finalizing    [ DONE ]</p>

<p>■ / . . 『. .    &hellip; . ■ . . • &hellip; - • ~ ■ ■ ■ ■&rsquo;</p>

<p>**** Installation completed successfully ******</p>

<p>Additional information:</p>

<p>*    Time synchronization installation was skipped. Please note that</p>

<p>unsynchronized time on server instances might be problem for some Open$tack components,    ’    ：，</p>

<p>*    File /root/keystonerc一admin has been created on OpenStack client host 58.64.138.219. To use the command line tools you need to source the file.</p>

<p>*    To access the OpenStack Dashboard browse to http: Z/58.64.138.219/dashboard . Please, find your login credentials stored in the keys toner e 一 admin in your home</p>

<p>directory.</p>

<p>*    To use Nagios, browse to <a href="http://58.64.138.219/nagios">http://58.64.138.219/nagios</a> username : nagiosadmin, password : bcb0bc9462fd4blto</p>

<p>*    Because of the kernel update the host 58.64»138;219 requires reboot.</p>

<p>*    The installation log file is available at: /var/tmp/packstack/20140524-153355~0XmeUf/openstack-setup.log</p>

<p>* The generated manifests are available at: /var/tmp/packstack/20140524-153355-0ImeUf/manifests</p>

<p>在上面的信息中，除了告诉用户已经安装部署完成之外，还有其他的一些附加信息，这些 信息包括提醒用户当前主机上面没有安装NTP服务，因此，时间同步的相关配置被跳过去了； 脚本文件/root/keystonerc_admin已经被创建了，如果用户需要使用命令行工具来配置 OpenStack，则应该首先使用source命令读取并且执行其中的命令；用户可以通过 <a href="http://58.64.138.219/dashboard%e6%9d%a5%e8%ae%bf%e9%97%aeDashboard,%e5%8d%b3%e6%8e%a7%e5%88%b6%e5%8f%b0%ef%bc%8c%e7%99%bb%e5%bd%95%e4%bf%a1%e6%81%af%e5%ad%98%e5%82%a8%e5%9c%a8%e7%94%a8%e6%88%b7%e4%b8%bb%e7%9b%ae%e5%bd%95%e4%b8%ad%e7%9a%84">http://58.64.138.219/dashboard</a><a href="http://58.64.138.219/dashboard%e6%9d%a5%e8%ae%bf%e9%97%aeDashboard,%e5%8d%b3%e6%8e%a7%e5%88%b6%e5%8f%b0%ef%bc%8c%e7%99%bb%e5%bd%95%e4%bf%a1%e6%81%af%e5%ad%98%e5%82%a8%e5%9c%a8%e7%94%a8%e6%88%b7%e4%b8%bb%e7%9b%ae%e5%bd%95%e4%b8%ad%e7%9a%84">来访问Dashboard,即控制台，登录信息存储在用户主目录中的</a> keystonerc admin 文件里面；用户可以通过 <a href="http://58.64.138.219/nagios">http://58.64.138.219/nagios</a> 来访问 Nagios，并给出 了用户名和密码。此外还有一些安装日志文件的位置信息。</p>

<p>由于CentOS 7使用yum源的关系，安装某些组件时可能会失败，例如mariaDB，此时只 需手动将其安装好并设置其访问权限继续安装即可。具体细节可参考mariaDB相关文档了解,</p>

<p>此处不再赘述。</p>

<p><img src="11 CentOS7fbdfa1060ed0f49e18-264.jpg" alt="img" /></p>

<p>每次使用&ndash;allinone选项来安装OpenStack都会自动创建一个应答文件。因此如果在安 装过程中出现了问题，重新执行单节点安装时，应该使用-answer-file指定自动创建的 应答文件。</p>

<h4 id="12-5">12.5</h4>

<p>理 OpenStack</p>

<p>OpenStack提供了许多命令行的工具来管理配置各项功能，但是这需要记忆大量的命令和 选项，对于初学者来说，其难度非常大。通过Horizon控制台，则可以非常方便地管理OpenStack 的各项功能，对于初学者来说，是一个便捷的途径。本节主要介绍通过控制台管理OpenStack。</p>

<p>12.5.1登录控制台</p>

<p>安装成功之后，用户就可以通过浏览器来访问控制台，其地址为主机的ip地址加上 dashboard,例如，在本例中，主机的IP地址为58.64.138.219,所以其默认的控制台网址为：</p>

<p><a href="http://58.64.138.219/dashboatd">http://58.64.138.219/dashboatd</a>    -</p>

<p>控制台登录界面如图12.5所示。</p>

<p>♦- C ，58 64.n8719/ddshtxbv&lt;l    ‘t 瘙 R S</p>

<p>.-&hellip;&hellip;&hellip;&hellip;.:&hellip;..•&hellip;&hellip;..-vu.4.ai5ffl1a»aaa«fc41aiasi&amp;«saiKxi4ajt/iii,»iiii*-___-.v.-.s-.-jc.-.</p>

<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>j</td>
<td>a</td>
<td></td>
</tr>

<tr>
<td></td>
<td>openstack</td>
<td></td>
</tr>

<tr>
<td>登录</td>
<td></td>
<td></td>
</tr>

<tr>
<td>囲户私i! :&hellip;&hellip;&hellip;&hellip;..</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p>图12.5控制台登录界面</p>

<p>在上面的一节中，当OpenStack部署的最后，告诉用户控制台的登录信息位于用户主目录 的keystonerc admin文件中，所以可以使用以下命令查看该文件的内容：</p>

<p>[root@localhost # more keystonerc一admin</p>

<p>export OS_USERNAME=admin</p>

<p>export OS一TENANT—NAME^admin</p>

<p>export OS_PASSWORDs=191ae4adl2da48cie</p>

<p>export OS__AUTH_URL=<a href="http://58.64,138.219:5000/v2.0/">http://58.64,138.219:5000/v2.0/</a></p>

<p>exP°rt PSl=&rsquo;[\u@\h \W(keystone_adInin)3\$ &lsquo;</p>

<p>在上面的代码中，OS_USERNAME就是控制台的用户名，而OS_PASSWORD则是控制 台的登录密码，这个命名由Packstack自动生成，所以比较复杂。</p>

<p>登录成功之后，会出现控制台主界面，如图12.6所示。左侧为导航栏，分为“项目”和 “管理员”两大菜单项。如果使用普通用户登录，则只出现“项目”菜单项。</p>

<p>图12.6控制台主界面</p>

<p>“项目”菜单项中包含了用户安装的各组件，二级菜单根据用户选择的组件有所变化。在 本例中，包含了计算、网络和对象存储3个菜单项。其中“计算”菜单项中包含了与计算节点 有关的功能，例如实例、云硬盘、镜像，以及访问和安全等。“网络”则包含了网络拓扑、虚 拟网络以及路由等。“对象”主要包含容器的管理。</p>

<p>“管理员”菜单项包含与系统管理有关的操作，主要有“系统面板”和“认证面板”两个菜 单项，“系统面板”包含了 “虚拟机管理器”、“主机集合”、“实例”以及“云磁盘”等菜单项。其 中，用户可以通过“系统信息”菜单项来查看当前安装的服务及其主机，如图12.7所示。</p>

<p>，’« O*&lt; * &lsquo;B«»* •    »    2 fi|c« « &lsquo; |fc« &gt;</p>

<p>令 C „ «.M.l38219/：i.:sJuvwid/admin/info/ ««    ! 系统饴.S.</p>

<p>番</p>

<p>曜P</p>

<p>眼务</p>

<p>««</p>

<p>mutron</p>

<p>tfarc.</p>

<p>n&lt;fc*_»c2</p>

<p>AM*</p>

<p>K*yste«a</p>

<p>w人？I    rj»5*</p>

<p>■n</p>

<p>com&lt;iul«</p>

<p>natwoik</p>

<p>*oknn»i?</p>

<p>sJ</p>

<p>•nag.</p>

<p>•cj</p>

<p>JtortHV (&ldquo;Mi&rsquo;* (MU)</p>

<p>生龍</p>

<p>SIM 1.W719</p>

<p>68WJMJW</p>

<p>S«C4 13«21S</p>

<p>13G2I9</p>

<p>S8M：3«21«</p>

<p>S9 61</p>

<p>M«T»7n</p>

<p>MS4 13Sa)9</p>

<p>S8 6*136 219</p>

<p>■s</p>

<p>Emelrtf</p>

<p>En*W*il</p>

<p>EnaiM</p>

<p>EixWM</p>

<p>En«M»&lt;</p>

<p>&amp;ISOM</p>

<p>EraUfd</p>

<p>FnaWtd</p>

<p>EnMMd</p>

<p>图12.7所安装的OpenStack服务及其主机</p>

<p>“认证面板”主要与用户认证有关，包含“项目”和“用户”两个菜单项，其中项目实际 上指的就是租户，而用户指的是系统用户。</p>

<p>12.5.2用户设置</p>

<p>单击主界面右上角的用户名对应的下拉菜单，选择“设置”命令，打开“用户设置”窗口， 如图12.8所示。</p>

<p>O*甲&rdquo;H 1■- ■廣氏，a    * Cr,f* M &lsquo;    »■» » S* 幽■嚷:    _</p>

<p>s</p>

<table>
<thead>
<tr>
<th>Q openstack</th>
<th>admin    &lsquo;r</th>
<th></th>
<th></th>
<th>«a；</th>
</tr>
</thead>

<tbody>
<tr>
<td>!</td>
<td>•    户设置</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>汲员</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>;：</td>
<td>用户设罝</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>j isn</td>
<td>-</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td></td>
<td>a翥.</td>
<td></td>
<td>说明，</td>
<td></td>
</tr>

<tr>
<td>||用户佘z</td>
<td>灣体屮文lzh&lt;nj</td>
<td>•</td>
<td>勺m户tf改</td>
<td></td>
</tr>

<tr>
<td>tf疔</td>
<td>MS</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td></td>
<td>UTC</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td></td>
<td>百教20</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p>用户可以设置“语言”和“时区”等选项。单击左侧的“修改密码”菜单项，打开“修改 密码”窗口，输入当前的密码，就可以修改用户密码，如图12.9所示。</p>

<p><img src="11 CentOS7fbdfa1060ed0f49e18-266.jpg" alt="img" /></p>

<p>不过目前来说，用户设置里的语言和时区的设置，只是保存在Cookie里面，并没有存储 在数据库里。默认语言是根据浏览器的语言来决定的，用户的个性化的设置，都是无法保存。 因为目前Keystone无法存放这些数据，所以用户也无法修改邮箱，也就导致无法实现取回密 码功能。</p>

<p>12.5.3管理用户</p>

<p>在“管理员”菜单中，选择“用户”菜单项，窗口的右侧列出了当前系统的各个用户，如 图12.10所示。</p>

<p>Qist x 0 m ■»</p>

<p>. C ： 58.64.138.219/cla&rsquo;4&gt;bo.«<J/jdiTi»>/useis/</p>

<p>w.nY</p>

<p>openstack</p>

<p>系快曲K 认证曲K</p>

<p>项a</p>

<p>odmln</p>

<p>用户</p>

<p>用户</p>

<p>□    用户名    麯嚷</p>

<p>E3 admin    coni</p>

<p>neutron    neution@)localhos&gt;</p>

<p>t?    swift    iwft@,ccaAwst</p>

<p>glance    gianc«@ioca8w$t</p>

<p>IS    tfeme</p>

<p>jS    cinder    ciml«»@loca!h&lt;ist</p>

<p>Lj    aSt_demo</p>

<p>:纖睡，:：</p>

<p>么蜱B</p>

<p>0,    <em>&gt;»    + 触 mr</em>    EE3E9</p>

<p>通</p>

<p>爾戸10    S    动作</p>

<p>6c321»a16d«66»41W7fiS328c3«b    True    B 多</p>

<p>?5b1«0^f ,(M530be451fi62(Jbe411be    Tn»    !««    B 乡</p>

<p>94c2«22(D37al1a29c19238CJOaJ4000 True    !«組更多</p>

<p>单击右侧的“编辑”菜单，可以修改当前的用户。选择某个用户左侧的复选框，然后单击 “删除用户”按钮，可以将选中的用户删除。单击“创建用户”按钮，可以打开“创建用户&rdquo; 对话框，如图12.11所示。在“用户名”、“邮箱”、“密码”以及“确认密码”等文本框中输入 相应的信息，选择“主项目”和“角色”之后，单击“创建用户”按钮即可完成用户的创建。</p>

<p>O&rsquo; 9-    &lsquo;H=    H-    &lsquo;V s-    釅，“.…广:一一</p>

<p>图I2.ll创建用户</p>

<p>12.5.4管理镜像</p>

<p>用户可以管理当前OpenStack中的镜像文件。前面已经介绍过，Glance支持很多格式，但 是对于企业来说，其实用不了那么多格式。用户可以自己制作镜像文件，也可以从网络上面下 载已经制作好的镜像文件。以下网址列出了常用的操作系统的镜像文件：</p>

<p>http: //openstack. redhat.com/Image_resources</p>

<p>下面以CentOS 6.5为例，说明如何创建一个镜像。</p>

<p>(1)    进入“管理员”一 “系统面板”，选择“镜像”菜单项，右侧列出了当前系统中的镜 像，如图12.12所示。</p>

<p>(2)    单击右上侧的“创建镜像”按钮，打开“创建一个镜像”窗口，如图12.13所示。</p>

<p>在“名称”文本框中输入镜像的名称，例如CentOS 6.5,在“描述”文本框中输入相应的 描述信息，在“镜像源”下拉菜单中选择“镜像地址”选项，在“镜像地址”文本框中输入 CentOS 6.5镜像文件的地址为：</p>

<p><a href="http://repos•fedorapeople.org/repos/openstack/guest-images/centos-6.5-20140">http://repos•fedorapeople.org/repos/openstack/guest-images/centos-6.5-20140</a> 117.0.x86_64.qcow2</p>

<p>“格式化”下拉菜单选择相应的文件格式在本例中选择“QCOW2-QEMU模拟器”选 项。选中“公有”复选框，如果不是生产环境，其他的选项可以保留默认值。</p>

<p>图12.12镜像列表</p>

<p>图12.13创建镜像</p>

<p>(3)    单击&rdquo;创建镜像”按钮，关闭窗口。在镜像列表中列出了刚才创建的镜像，其状态 为 Saving o</p>

<p>(4)    由于需要把整个镜像文件下载下来，所以需要较长的时间。到镜像的状态变成Active 时，表示镜像已经创建成功，处于可用状态，如图12.14所示。</p>

<p>图12.14镜像创建成功</p>

<p>对于其他的镜像文件，用户可以采用类似的步骤来完成创建操作。</p>

<p>如果用户想要修改某个镜像的信息，可以单击相应行的右侧的“编辑”按钮，打开“上传</p>

<p>镜像”对话框，如图12.15所示。</p>

<p>图12.15修改镜像信息</p>

<p>修改完成之后，单击右下角的“上传镜像文件”按钮关闭对话框。</p>

<p>如果用户不再需要某个镜像文件，可以单击右侧的“更多”按钮，选择“删除镜像”命令， 即可将该镜像文件删除。</p>

<p>12.5.5管理云主机类型</p>

<p>云主机类型(Flavors)实际上对云主机的硬件配置进行了限定。进入“管理员”菜单里面 的“系统面板”，单击“云主机类型”菜单项，窗口的右侧列出了当前已经预定义好的主机类 型，如图12.16所示，从图中可以得知，系统默认已经内置了 5个云主机类型，分别是ml.tiny、 ml.small、ml.medium, ml.large和ml.xlarge。从表格中可以看出，这5个内置的类型的硬件 配置是从低到高的，主要体现在CPU的个数、内存以及根磁盘这3个方面。</p>

<p>图12.16云主机类型</p>

<p>这5个类型已经基本满足用户的需求。如果用户需要其他配置的主机类型，则可以创建新 的主机类型。下面介绍创建新的主机类型的步骤。</p>

<p>(1)    单击图12.16中右上角的“创建云主机类型”按钮，打开“创建云主机类型”窗口。 在“名称”文本框中输入主机类型的名称，如ml.lg, ID文本框保留原来的auto,表示自动 生成ID。虚拟内核实际上指的是云主机CPU的个数，在本例中输入2。内存以MB为单位， 在本例中输入1024,根磁盘的容量以GB为单位，在本例中输入10。临时磁盘和交换盘空间 都为0，如图12.17所示。</p>

<p>(2)    单击窗口上面的“云主机类型访问”，切换到“云主机类型访问”选项卡。在窗口的 左侧列出了当前系统中所有的租户，右侧则列出了可以访问该主机类型的租户。单击某个租户 右侧的O按钮，将该租户添加到右侧，赋予该租户使用该类型的权限，如图12.18所示。</p>

<p>(3)设置完成之后，单击右下角的“创建云主机类型”按钮，完成主机类型的创建。</p>

<p>除了添加主机类型之外，用户还可以修改主机类型的信息、修改使用权以及删除主机类型。</p>

<p>这些操作都比较简单，不再详细说明。</p>

<p>OpenStac&gt; K</p>

<p>创建云主机类型</p>

<p>云主倾2?值恩</p>

<p>fl;可以&amp;这里6®题的云主机类型来组织.买例资S ■</p>

<p>©</p>

<p>曲M内検</p>

<p>内存M8</p>

<p>祺秘ftGR</p>

<p>10</p>

<p>磁盘</p>

<dl>
<dt>番空HMB</dt>
</dl>

<p>:o</p>

<p>创建丢i极类2?</p>

<p>图12.17创建主机类型</p>

<p>图12.18指定云主机类型的访问权限</p>

<p>346</p>

<p>12.5.6管理网络</p>

<p>Neutron是OpenStack核心项目之一，提供云计算环境下的虚拟网络功能。Neutron的功能 日益强大，并在Horizon面板中已经集成该模块。为了能够使得读者更好地掌握网络的管理， 下面首先介绍一下Neutron的几个基本概念。</p>

<p>\1.    网络</p>

<p>在普通人的眼里，网络就是网线和供网线插入的端口，一个盒子会提供这些端口。对于网 络工程师来说，网络的盒子指的是交换机和路由器。所以在物理世界中，网络可以简单地被认 为包括网线、交换机和路由器。当然，除了物理设备，还有软件方面的组成部分，例如IP地 址、交换机和路由器的配置和管理软件以及各种网络协议。要管理好一个物理网络需要非常多 的网络专业知识和经验。</p>

<p>Neutron网络目的是划分物理网络，在多租户环境下提供给每个租户独立的网络环境。另 外，Neutron提供API来实现这种目标。Neutron中“网络”是一个可以被用户创建的对象， 如果要和物理环境下的概念映射的话，这个对象相当于一个巨大的交换机，可以拥有无限多个 动态可创建和销毁的虚拟端口。</p>

<p>\2.    端口</p>

<p>在物理网络环境中，端口是用于连接设备进入网络的地方。Neutron中的端口起着类似的 功能，它是路由器和虚拟机挂接网络的着附点。</p>

<p>\3.    路由器</p>

<p>和物理环境下的路由器类似，Neutron中的路由器也是一个路由选择和转发部件。只不过 在Neutron中，它是可以创建和销毁的软部件。</p>

<p>\4.    子网</p>

<p>简单地说，子网是由一组IP地址组成的地址池。不同子网间的通信需要路由器的支持， 这个Neutron和物理网络下是一致的。Neutron中子网隶属于网络。图12.19描述了一个典型 的Neutron网络结构。</p>

<p>在图12.19中，存在一个和互联网连接的Neutron外部网络。这个外部网络是租户虚拟机 访问互联网或者互联网访问虚拟机的途径。外部网络有一个子网A，它是一组在互联网上可寻 址的IP地址。一般情况下，外部网络只有一个，且由管理员创建和管理。租户网络可由租户 任意创建。当一个租户的网络上的虚拟机需要和外部网络以及互联网通信时，这个租户就需要 一个路由器。路由器有两种臂，一种是网关（gateway）臂，另一种是网络接口臂。网关臂只 有一个，连接外部网。接口臂可以有多个，连接租户网络的子网。</p>

<p>图12.19典型的Neutron网络结构</p>

<p>对于图12.19所示的网络结构，用户可以通过以下的步骤来实施：</p>

<p>(1)    首先管理员拿到一组可以在互联网上寻址的IP地址，并且创建一个外部网络和子网。</p>

<p>(2)    租户创建一个网络和子网。</p>

<p>(3)    租户创建一个路由器并且连接租户子网和外部网络。</p>

<p>(4)    租户创建虚拟机。</p>

<p>接下来介绍如何在控制台中实现以上网络。管理员登录控制台，选择“管理员”面板，单 击“网络”菜单项后显示当前网络列表，如图12.20所示。</p>

<p>图12.20网络列表</p>

<p>从图12.20中可以得知，OpenStack已经默认创建了一个名称为public的外部网络，并且 己经拥有了一个名称为public_subnet,网络地址为172.24.4.224/28的子网。</p>

<p>单击右上角的“创建网络”按钮，可以打开“创建网络”窗口，创建新的外部网络，如图 12.21所示。</p>

<p>图12.21创建网络</p>

<p>尽管Neutron支持多个外部网络，但是在多个外部网络存在的情况下，其配置会非常复杂， 所以不再介绍创建新的外部网络的步骤，而是直接使用已有的名称为public的外部网络。在网 络列表窗口中，单击网络名称就可以查看相应网络的详细信息，如图12.22所示。</p>

<p>图12.22 public的网络详情</p>

<p>可以看到，网络详情主要包含3个部分，分别是网络概况、子网和端口。网络概况部分描 述了外部网络的重要属性，例如名称、ID、项目ID以及状态等。子网部分列出了该网络划分 的子网，包含子网名称、网络地址以及网关等信息。用户可以添加或者删除子网。端口部分列 出了网络中的网络接口，包括名称、固定IP、连接设备以及状态等信息。管理员可以修改端 口的名称，但是不能删除端口。</p>

<p>前面已经介绍过，除了外部网络之外，还有租户网络。租户网络主要包括子网、路由器等， 租户可以创建、删除属于自己的网络、子网以及路由器等。下面介绍如何管理租户网络。</p>

<p>(1)以普通用户demo登录控制台，在左侧的菜单中选择“网络”一“网络”，页面右侧 列出了当前系统中可用的网络列表，如图12.23所示。</p>

<p>图12.23 demo用户可用的网络</p>

<p>(2)单去“创建网络”按钮，打开“创建网络”窗口，如图12.24所示。在“网络名称” 文本框中输入网络的名称，例如Private3,单击“下一步”按钮，进入下一个界面。</p>

<p>图12.24设置网络名称</p>

<p>(3)如果需要创建子网，则选中“创建子网”复选框，在“子网名称”文本框中输入子 网的名称，例如private_subnet2,在“网络地址”文本框中输入子网的ID,例如192.168.21.0/24, 在“IP版本”下拉菜单中选择“IPv4”选项，在“网关IP”文本框中输入子网网关的IP地址, 例如192.168.21.1，如图12.25所示。单击“下一步”按钮，进入下一个界面。</p>

<p>图12.25设置子网</p>

<p>(4)选中“激活DHCP”复选框，在“分配地址池”文本框中输入DHCP地址池的范围， 例如192.168.21.2~192.168.21.128,在“DNS域名解析服务”文本框中输入DNS服务器的IP 地址，如图12.26所示。单击“已创建”按钮，完成网络的创建。</p>

<p>图12.26设置DHCP服务</p>

<p>通过上面的操作，租户己经创建了一个新的网络，但是这个网络还不能与外部网络连通。 为了连通外部网络，租户还需要创建和设置路由器。下面介绍如何通过设置路由器将新创建的 网络连接到外部网络。</p>

<p>(1)以demo用户登录控制台，选择“网络&rdquo;一 “路由”菜单，窗口右侧列出当前租户 可用的路由器，如图12.27所示。</p>

<p>图12.27租户路由器列表</p>

<p>在图12.27中列出了一个名称为router 1的路由器，该路由器为安装OpenStack时自动创 建的路由器。从图中可以得知，该路由器已经连接到名称为public的外部网络。</p>

<p>(2)单击路由器名称，打开“路由详情”窗口，如图12.28所示。该窗口主要包括路由 概览和接口两个部分，路由概览部分列出了路由器的名称、ID、状态和外部网关等信息。接 口部分列出了该路由器所拥有的连接到内部网络的接口。</p>

<p>4-    C ，&rsquo;: S8.&amp;4.138.219 J.-.,-: ■    : 0 彐</p>

<p>Q openstack    .    較 4</p>

<table>
<thead>
<tr>
<th>哦目    -</th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>Compute</td>
<td>» 1</td>
</tr>

<tr>
<td>:啪</td>
<td>，</td>
</tr>

<tr>
<td>哪拓朴</td>
<td></td>
</tr>
</tbody>
</table>

<p>I触</p>

<p>进象存tt</p>

<p>路由详情 路由概贫:rouuri</p>

<p>名称</p>

<p>routeri</p>

<p>ID</p>

<p>8477t)94a-998l-485f-&amp;883-68t11026ca98</p>

<p>扶态 ACTIVE</p>

<p>外薄网蛑哦</p>

<p>puWc</p>

<p>揸口</p>

<p>接口    &gt; miiE) gRSEa</p>

<table>
<thead>
<tr>
<th></th>
<th>酷IP</th>
<th></th>
<th>紐</th>
<th>货■员贿</th>
<th>动作</th>
</tr>
</thead>

<tbody>
<tr>
<td>@    (351S3944)</td>
<td>192168.1.1</td>
<td>ACTIVE</td>
<td>内部相□</td>
<td>UP</td>
<td></td>
</tr>

<tr>
<td>®    (55455ae8»</td>
<td>10.0.0.1</td>
<td>ACTIVE</td>
<td>內鵬□</td>
<td>UP</td>
<td></td>
</tr>
</tbody>
</table>

<p>a示2个帝目</p>

<p>图12.28路由详情页面</p>

<p>(3)单击“增加接口”按钮，打开“增加接口”对话框，如图12.29所示。在“子网” 下拉菜单中选择刚刚创建的网络private3的子网private_subnet2，“IP地址”文本框中输入接 口的IP地址，例如192.168.21.1,单击“增加接口”按钮，关闭对话框。</p>

<p>图12.29增加接口</p>

<p>现在这个租户的路由器已经连接了外网和租户的子网，接下来这个租户可以创建虚拟机， 这个虚拟机借助路由器就可以访问外部网络甚至互联网。选择“网络”一“网络拓扑”菜单， 可以查看当前租户的网络拓扑结构，如图12.30所示。</p>

<p>♦ G . S8.64.138.219/ :.    :    「：.&lsquo;•:、-</p>

<p>Oop^stack</p>

<p>*a    • R籍拓1b</p>

<p>■小■正*</p>

<p>a三</p>

<p>der»*- JWi</p>

<p>Coavwfe</p>

<p>抽9itS 田</p>

<p>,R*8W!</p>

<p>供由</p>

<p>P 163 1</p>

<p>ia o.q</p>

<p>图12.30 demo租户的网络拓扑结构</p>

<p>从图12.30可以得知，demo租户拥有3个网络，其名称分别为private、private2和private3, 其网络地址分别为10.0.0.0/24、192.168.1.0/24以及192.168.21.0/24,每个子网中都有几台虚拟 机。这3个网络分别连接到路由器routerl的3个接口上面，接口的IP地址分别为10.0.0.1、 192.168.1.1和192.168.21.1。实际上，这3个网络接口分别充当3个网络的网关。路由器routerl 的另外一个接口连接到外部网络public。</p>

<p>12.5.7管理实例</p>

<p>所谓实例(instance),实际上指的就是虚拟机。之所以称为实例，是因为在OpenStack中， 虚拟机总是从一个镜像创建而来的。下面介绍如何管理实例。</p>

<p>以demo用户登录控制台，进入“Compute” 一 “实例”菜单，窗口右侧列出当前租户所 拥有的实例，如图12.31所示。</p>

<p>图12.31实例列表</p>

<p>单击右上角的“启动云主机”按钮，打开“启动云主机”对话框，如图12.32所示。在“云 主机名称”文本框中输入主机名称，例如webserver。在“云主机类型’叩拉菜单中选择“ ml .small” 选项，创建一个CPU、20GB的硬盘以及2GB内存的虚拟机。“云主机数量”文本框中输入1， 即只创建一个虚拟机。“云主机启动源”下拉菜单选择“从镜像启动”选项，“镜像名称”下拉 菜单选择“cirros(12.5MB)”选项。</p>

<p>图12.32创建云主机</p>

<p>切换到“访问&amp;安全”选项卡，如图12.33所示。在“值对”下拉菜单中选择一个密钥 对作为访问虚拟机的方式。选中“安全组”中的“default”选项。</p>

<p>图12.33选择密钥对</p>

<p>如果目前还没有密钥对，则可以单击右侧的+按钮，打开“导入密钥对”对话框，如图 12.34所示。</p>

<p><img src="11 CentOS7fbdfa1060ed0f49e18-288.jpg" alt="img" /></p>

<p>在“密钥对名称”文本框中输入密钥对的标识，例如key2。然后在终端窗口中执行以下 命令：</p>

<p>[root@localhost # ssh-keygen -t rsa -f cloud.key</p>

<p><img src="11 CentOS7fbdfa1060ed0f49e18-289.jpg" alt="img" /></p>

<p>以上命令会创建一个名称为cloud.key的私钥文件以及名称为cloud.key.pub的公钥文件。 然后使用以下命令打开公钥文件：</p>

<p>[root@localhost # cat cloud,key.pub ssh-rsa</p>

<p>AAAAB3NzaClyc2E72LAAABIwAAAQEAxopk8A7 9Tp01ds2ySL63kiw/6t45F7ZRG10LLBjZXNQtleke4Y XnF/D/jvzMoYRG7Gj4gtvFxwFtqtYel9o00dQoN0tKrfTD4ajqUqFm+lqWNVkB7h0rtz0eiqHrv8Pd H5bRd4ifPtJn3nfPDd7hTbHGqoJnuppITnTQYKA20XRDwGQM/Ra3/+fJj6EkwgVwLQgOvbHLoXafEk TNlGHARlLZUwqy/i8eC53Tmgh+1310pnjXB5WAr4XLuCyhfnZ6ICXOp501rDTqU/FclGXEnqhc5wma 9Cjgi30hiXADNFJQlSBtWiS4J10nZBKkWzqXfOJSqX84pz6Znpc+tjphpQ==</p>

<p>root@localhost.localdomain</p>

<p>将其内容粘贴到图12.34中的“公钥”文本框中。单击“导入密钥对”按钮，完成密钥对 的创建。</p>

<p>切换到“网络”选项卡，可以看到所有的网络列表，如图12.35所示。</p>

<p>图12.35可用网络列表</p>

<p>单击要使用的网络右下角的O按钮，选中该网络，完成之后如图12.36所示。单击“运行” 按钮，完成虚拟机的创建。</p>

<p>图12.36选择网络</p>

<p>此时，冈棚创建的实例webserver已经出现在实例列表中，并且已经为其分配了一个地址 192.168.21.3。单击实例名称，打开云主机详情窗口。切换到“控制台”选项卡，可以看到该 虚拟机已经启动，如图12.37所示。</p>

<p>云主机控制台</p>

<p>識械栈破城盘奶栅:.她缺L.盘醜妓郎鎌&amp;. 滅ig.%*薄am.</p>

<p>图12.37实例控制台</p>

<p>尽管实例已经成功创建，但是此时仍然不能通过SSH访问虚拟机，也无法ping通该虚拟</p>

<p>机。这主要是因为安全组规则所限，所以需要修改其中的规则。</p>

<p>选择Compute — “访问&amp;安全”菜单，窗口右侧列出了所有的安全组，如图12.38所示。</p>

<p>图12.38安全组列表</p>

<p>由于前面在创建实例时使用了 default安全组，所以单击对应行中的“管理规则”按钮， 打开“安全组规则”窗口，如图12.39所示。</p>

<p>OS&rsquo; f：i-&gt;    r    乂、 □    -    ®    :______</p>

<p>4-    C ? 58.64.138.219 i &lsquo; 1    &rsquo; ； .■    ■彐</p>

<table>
<thead>
<tr>
<th>Q openstack</th>
<th>i &lt;tono    &lsquo; ji.</th>
<th>oemoX&rdquo;    看出</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>棚</td>
<td>.管理安金组规则:</td>
<td>default</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>Compute</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>安全组规则</td>
<td></td>
<td></td>
<td>4!糾納 I</td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
<td>方ft</td>
<td>曲入炱9</td>
<td>IP格设</td>
<td>嫡口范困 《8    动作</td>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
<td>XO</td>
<td>IPv4</td>
<td>ICMP</td>
<td>00 00/0 (QDRJ |</td>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
<td>出口</td>
<td>IPv6</td>
<td>任河</td>
<td>/0 iCIOR)    |</td>
<td></td>
</tr>

<tr>
<td>J访间&amp;尹g</td>
<td></td>
<td>入口</td>
<td>IPv6</td>
<td>任间</td>
<td>defaoN</td>
<td></td>
</tr>

<tr>
<td></td>
<td>入□</td>
<td>IPv4</td>
<td>任间</td>
<td>default    t</td>
<td></td>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>

<tr>
<td>^27 □</td>
<td>出口</td>
<td>IPv4</td>
<td>«钶</td>
<td>00 0.0/0 (CJCW) 1</td>
<td></td>
<td></td>
</tr>

<tr>
<td>砌存餹</td>
<td>»B示计条目</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p>图12.39 default安全组规则</p>

<p>单击“添加规则”按钮，打开“添加规则”对话框，如图12.40所示。在“规则”下拉菜 单中选择“ALLICMP”选项，单击“添加”按钮将该项规则添加到列表里面。再通过相同的 步骤，将SSH规则添加进去。前者使得用户可以ping通虚拟机，后者可以使得用户通过SSH 客户端连接虚拟机。</p>

<p>图12.40添加规则</p>

<p>为了能够使得外部网络中的主机可以访问虚拟机，还需要为虚拟机绑定浮动IP。在实例 列表中，单击webserver虚拟机所在行的最右边的“更多”按钮，选择“绑定浮动IP”命令， 打开“管理浮动IP的关联”对话框，在“IP地址”下拉菜单中选择一个外部网络的IP地址, 如图12.41所示。单击“关联”按钮，完成IP的绑定。</p>

<p>图12.41绑定浮动IP</p>

<p><img src="11 CentOS7fbdfa1060ed0f49e18-298.jpg" alt="img" /></p>

<p>如果IP地址下拉菜单中没有选项，则可以单击右侧的+按钮，添加浮动IP。</p>

<p>对于已经绑定浮动IP的虚拟机来说，其IP地址会有两个，分别为租户网络的IP地址和 外部网络地址，在本例中，虚拟机webserver的IP地址分别为192.168.21.3和172.24.4.229。 然后在终端窗口中输入ping命令，以验证是否可以访问虚拟机，如下所示：</p>

<p>(rootQlocalhost    # ping 172.24.4.229</p>

<p>of data. time=5.32 ms time=0.499 ms time^O.637 ms</p>

<p>PING 172.24.4.229 (172.24.4.229) 56(84) bytes 64 bytes from 172.24.4.229: icmp一seq=l ttl=63 64 bytes from 172.24.4.229: icmp_seq«2 64 bytes from 172.24.4.229: icmp一seq=3 ttl=63</p>

<p>从上面的命令可以得知，外部网络中的主机已经可以访问虚拟机。接下来使用SSH命令 配合密钥来访问虚拟机，如下所示：</p>

<p>[root^localhost # ssh -i cloud.key <a href="mailto:cirros@172.24.4.229">cirros@172.24.4.229</a></p>

<p>可以发现，上面的命令己经成功登录虚拟机，并且出现了虚拟机的命令提示符$符号。下 面验证虚拟机能否访问互联网，输入以下命令：</p>

<p>$ ping <a href="http://www.google.com">www.google.com</a></p>

<p>可以发现，虚拟机已经可以访问互联网上的资源。</p>

<p>如果用户想要重新启动某台虚拟机，则可以单击对应行的右侧的“更多”按钮，选择“软 重启云主机”或者“硬重启云主机”命令，来实现虚拟机的重新启动。</p>

<p>此外，用户还可以删除虚拟机、创建快照以及关闭虚拟机。这些操作都比较简单，不再详 细说明。</p>

<h5 id="12-6小结">12®6小结</h5>

<p>本章详细介绍了在CentOS 7上面安装部署OpenStack的方法。主要内容包括OpenStack 的基础知识，OpenStack的体系架构，OpenStack的部署工具，使用RDO部署OpenStack以及 管理OpenStack等。重点在于掌握好OpenStack的体系架构，使用RDO部署OpenStack的方 法以及镜像、虚拟网络和实例的管理。</p>

<h6 id="第13蠢">第13蠢</h6>

<h2 id="相关资料">相关资料</h2>

<ul>
<li><a href="http://www.cnblogs.com/kevingrace/p/5733508.html">OpenStack构架知识梳理</a></li>
</ul>

    </div>

    
    

    
    

    <footer class="post-footer">
      

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/03-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/05-%E5%9F%BA%E7%A1%80%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/02-%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/01-%E5%90%8E%E7%AB%AF%E7%8E%AF%E5%A2%83/01-linux-%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83/centos7-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E4%B8%8E%E8%BF%90%E7%BB%B4%E5%AE%9E%E6%88%98/08-%E9%9B%86%E7%BE%A4/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">08 集群</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/01-%E7%9F%A5%E8%AF%86%E6%A0%91/03-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/01-%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A8%8B/01-%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/02-python/%E7%BC%96%E5%86%99%E9%AB%98%E8%B4%A8%E9%87%8F%E4%BB%A3%E7%A0%81-%E6%94%B9%E5%96%84-python-%E7%A8%8B%E5%BA%8F%E7%9A%8491%E4%B8%AA%E5%BB%BA%E8%AE%AE/aa/">
            <span class="next-text nav-default">aa</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="iteratelyd@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="http://github.com/iterateself" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/thebegin/activities" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/people/68028070/" class="iconfont icon-douban" title="douban"></a>
  <a href="http://iterate.site/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
    <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2018
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">iterateself</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="/lib/highlight/highlight.pack.js?v=20171001"></script><script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>


<script type="text/javascript" src="/dist/even.min.js?v=3.2.0"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>








</body>
</html>
